<HBProfile xsi:noNamespaceSchemaLocation="../Schemas/EchoSchema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- Original contribution by EchoTiger -->
	<Name>Troll Starter ($Rev: 6041 $)</Name>

	<MinDurability>0.3</MinDurability>
	<MinFreeBagSlots>3</MinFreeBagSlots>

	<SellGrey>true</SellGrey>
	<SellWhite>true</SellWhite>
	<SellGreen>true</SellGreen>
	<SellBlue>true</SellBlue>
	<SellPurple>false</SellPurple>

	<MailGrey>false</MailGrey>
	<MailWhite>true</MailWhite>
	<MailGreen>true</MailGreen>
	<MailBlue>true</MailBlue>
	<MailPurple>true</MailPurple>

	<TargetElites>true</TargetElites>

	<AvoidMobs>
	</AvoidMobs>

	<Mailboxes>
	</Mailboxes>

	<Vendors>
	</Vendors>

	<Blackspots>
	</Blackspots>

	<Blacklist>
	</Blacklist>

	<QuestOrder IgnoreCheckpoints="false" ContinuallySkipToCheckpoints="true" >
		<If Condition="Me.IsAlliance" >
			<Code File="LoadProfile" ProfileName="..\..\Alliance\1-58 Autoloader.xml" RememberProfile="true" />
		</If>
		<!-- RunCode Methods -->
			<Code File="RunCode">
			<![CDATA[
				Bots.Professionbuddy.PBLog.Log(System.Windows.Media.Colors.MediumPurple, "> [Profile Initialization Status] ", System.Windows.Media.Colors.CornflowerBlue, "\n     Auto-Looting	:: Enabled\n     Looting	:: Enabled\n     Game Addons	:: Disabled");
				Lua.DoString("SetCVar('AutoLootDefault', 1);");
				CharacterSettings.Instance.LootMobs = true;
				CharacterSettings.Instance.Save();
				Lua.DoString("for i=1,GetNumAddOns() do local relo=false if IsAddOnLoaded(i) then relo=true DisableAddOn(i) end if relo then relo=nil ReloadUI() end end");
				await Coroutine.Sleep(1500);
				Logging.Write(System.Windows.Media.Colors.MediumPurple, "> [Ready to bot!]");
			]]>
			</Code>
			<Code File="RunCode" Type="Definition">
				<![CDATA[
						bool DoQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (HasQuest(questId) && !IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool NeedsQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (!HasQuest(questId) && !IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool NeedsBreadcrumbQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (IsQuestCompleted(questId)) return false;
							}
							return true;
						}
						bool QuestDone(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (HasQuest(questId) && IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool QuestFlaggedCompleted(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								return Lua.GetReturnVal<bool>($"return IsQuestFlaggedCompleted({questId});", 0);
							}
							return false;
						}
						async Task SkipCutscene(int preWait = 3000, int postWait = 3000)
						{
					// Add detection of cutscene here.
							await Coroutine.Sleep(preWait);
					// Test and improve the working method.
							Lua.DoString("MovieFrame:StopMovie(); CinematicFrame_CancelCinematic(); StopCinematic();");
							await Coroutine.Sleep(postWait);
						}
					]]>
			</Code>
		<!-- END RunCode Methods -->

		<!-- Hooks -->
			<Code File="RunCode" Type="Definition">
				<![CDATA[ 
					IEnumerable<WoWItem> GetExtraConsumables()
					{
						uint foodCount = 0;
						uint drinkCount = 0;
						// Skip conjured and buff comsumables.
				
						var extraConsumables = (from item in Me.BagItems
										   where item != null && item.ItemInfo != null
										   let isFood = Consumable.IsFood(item.ItemInfo)
										   let isDrink = Consumable.IsDrink(item.ItemInfo)
										   where (isFood || isDrink) && item.ItemInfo.SellPrice > 0 && item.Effects.Count == 1 && item.ItemInfo.RequiredLevel < Me.Level - 10                    
										   select item).ToList();
				
				
						var extraPotions = Me.BagItems
							.Where(c => c != null && c.IsValid && c.ItemInfo != null && c.ItemInfo.SellPrice > 0 && c.Effects.Count == 1
								&& (c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Potion
								|| c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Elixir
								|| c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Flask)
								&& c.ItemInfo.RequiredLevel < Me.Level - 20);
				
						extraConsumables.AddRange(extraPotions);
						return extraConsumables;
					}
					 
					async Task SellExtraConsumables()
					{
						Logging.Write("Selling items in GetExtraConsumables()");
						foreach (var item in GetExtraConsumables())
						{
							Logging.Write("Selling {0}.", item.Name);
							item.UseContainerItem();
							await Coroutine.Sleep(1337);
						}
					}
				]]>
			</Code>
			<Code File="Hooks\DoWhen" AllowExecutionWhileNotAlive="false"  AllowUseWhileMounted="true" ActivityName="SellExtraConsumables" UseWhen="MerchantFrame.Instance.IsVisible &amp;&amp; GetExtraConsumables().Any()" >
				<Code File="RunCode" Code="await SellExtraConsumables();"/>
			</Code>
		<!-- END Hooks -->

		<PickUp QuestName="The Rise of the Darkspear" QuestId="24764" GiverName="Jin&apos;thala" GiverId="37951" X="-1171.45" Y="-5263.65" Z="0.8481997" />
		<TurnIn QuestName="The Rise of the Darkspear" QuestId="24764" TurnInName="Zen&apos;tabra" TurnInId="38243" X="-1175.964" Y="-5536.096" Z="11.94465" />

		<PickUp QuestName="The Basics: Hitting Things" QuestId="24765" GiverName="Zen&apos;tabra" GiverId="38243" X="-1175.964" Y="-5536.096" Z="11.94465" />
			<CustomBehavior File="RunCode"><![CDATA[ TreeHooks.Instance.InsertHook("Questbot_Main", 0, _stopcombatComposite ?? (_stopcombatComposite = new  CommonBehaviors.Actions.ActionRunCoroutine(ctx => StopCombat()))); ]]> </CustomBehavior>
			<CustomBehavior File="RunCode" Type="Definition" ><![CDATA[
					private Styx.TreeSharp.Composite _stopcombatComposite;
					public async Task<bool> StopCombat()
					{
						if (!QuestDone(24765)) return false;
						if (BotPoi.Current.Type != PoiType.Kill) return false;
						BotPoi.Clear();
						return true;
					}
			]]>
			</CustomBehavior>
			<Code File="KillUntilComplete" MobId="38038" QuestId="24765" X="-1174.382" Y="-5519.634" Z="12.35504" />
			<Code File="RunCode"><![CDATA[ TreeHooks.Instance.RemoveHook("Questbot_Main", _stopcombatComposite); ]]></Code>
		<TurnIn QuestName="The Basics: Hitting Things" QuestId="24765" TurnInName="Zen&apos;tabra" TurnInId="38243" X="-1172.986" Y="-5537.554" Z="11.94298" />

		<PickUp QuestName="A Rough Start" QuestId="24767" GiverName="Zen&apos;tabra" GiverId="38243" X="-1172.986" Y="-5537.554" Z="11.94298" />
		<Code File="KillUntilComplete" MobId="38046" QuestId="24767" >
			<HuntingGrounds>
				<Hotspot X="-1094.444" Y="-5616.467" Z="14.57797" />
				<Hotspot X="-1195.334" Y="-5616.909" Z="14.79196" />
				<Hotspot X="-1232.066" Y="-5500.679" Z="14.70079" />
			</HuntingGrounds>
		</Code>
		<TurnIn QuestName="A Rough Start" QuestId="24767" TurnInName="Zen&apos;tabra" TurnInId="38243" X="-1173.96" Y="-5536.537" Z="11.95022" />

		<PickUp QuestName="Proving Pit" QuestId="24768" GiverName="Zen&apos;tabra" GiverId="38243" X="-1173.96" Y="-5536.537" Z="11.95022" />
		<While Condition="DoQuest(24768)" >
			<Code File="InteractWith" MobId="39062" GossipOptions="1" NonCompeteDistance="0" InteractBlacklistTimeInSeconds="1" QuestId="24768" X="-1162.095" Y="-5531.158" Z="11.97586" TerminateWhen="Unit(38142, u =&gt; u.Attackable) != null" />
			<Code File="KillUntilComplete" MobId="38142" QuestId="24768" X="-1148.786" Y="-5532.944" Z="8.105022" TerminateWhen="Unit(38142, u =&gt; u.Attackable) == null" />
		</While>
		<TurnIn QuestName="Proving Pit" QuestId="24768" TurnInName="Zen&apos;tabra" TurnInId="38243" X="-1158.094" Y="-5531.59" Z="11.72109" />

		<PickUp QuestName="More Than Expected" QuestId="24769" GiverName="Zen&apos;tabra" GiverId="38243" X="-1158.094" Y="-5531.59" Z="11.72109" />
		<TurnIn QuestName="More Than Expected" QuestId="24769" TurnInName="Vol&apos;jin" TurnInId="38966" X="-1314.463" Y="-5599.671" Z="23.71969" />

		<PickUp QuestName="Moraya" QuestId="25064" GiverName="Vol&apos;jin" GiverId="38966" X="-1314.463" Y="-5599.671" Z="23.71969" />

		<PickUp QuestName="Crab Fishin&apos;" QuestId="25037" GiverName="Tora&apos;jin" GiverId="39007" X="-1277.715" Y="-5584.758" Z="21.00058" />
		<Code File="KillUntilComplete" MobId="39004" QuestId="25037" >
			<HuntingGrounds>
				<Hotspot X="-1195.888" Y="-5692.071" Z="1.144262" />
				<Hotspot X="-1105.067" Y="-5690.657" Z="-0.3782958" />
			</HuntingGrounds>
		</Code>
		<TurnIn QuestName="Crab Fishin&apos;" QuestId="25037" TurnInName="Tora&apos;jin" TurnInId="39007" X="-1281.243" Y="-5588.295" Z="21.00638" />

		<TurnIn QuestName="Moraya" QuestId="25064" TurnInName="Moraya" TurnInId="38005" X="-1292.582" Y="-5521.677" Z="20.76698" />
		<PickUp QuestName="A Troll&apos;s Truest Companion" QuestId="24622" GiverName="Moraya" GiverId="38005" X="-1292.582" Y="-5521.677" Z="20.76698" />
		<TurnIn QuestName="A Troll&apos;s Truest Companion" QuestId="24622" TurnInName="Kijara" TurnInId="37969" X="-1547.254" Y="-5311.067" Z="8.211567" />
		<PickUp QuestName="Saving the Young" QuestId="24623" GiverName="Kijara" GiverId="37969" X="-1547.254" Y="-5311.067" Z="8.211567" />
		<PickUp QuestName="Mercy for the Lost" QuestId="24624" GiverName="Tegashi" GiverId="37987" X="-1548.225" Y="-5314.966" Z="7.974018" />
		<PickUp QuestName="Consort of the Sea Witch" QuestId="24625" GiverName="Tegashi" GiverId="37987" X="-1548.225" Y="-5314.966" Z="7.974018" />

		<Code File="KillUntilComplete" MobId="39072" QuestId="24625" X="-1353.536" Y="-5159.622" Z="13.4896" />

		<Code File="InteractWith" MobId="39157" CollectionDistance="200" InteractByUsingItemId="52283" QuestId="24623" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-1306.902" Y="-5174.234" Z="1.187117" />
				<Hotspot X="-1397.547" Y="-5134.247" Z="1.968089" />
			</HuntingGrounds>
		</Code>

		<Code File="KillUntilComplete" MobId="37961" QuestId="24624" >
			<HuntingGrounds>
				<Hotspot X="-1306.902" Y="-5174.234" Z="1.187117" />
				<Hotspot X="-1397.547" Y="-5134.247" Z="1.968089" />
			</HuntingGrounds>
		</Code>

		<TurnIn QuestName="Mercy for the Lost" QuestId="24624" TurnInName="Tegashi" TurnInId="37987" X="-1545.624" Y="-5313.12" Z="8.049932" />
		<TurnIn QuestName="Consort of the Sea Witch" QuestId="24625" TurnInName="Tegashi" TurnInId="37987" X="-1545.624" Y="-5313.12" Z="8.049932" />
		<TurnIn QuestName="Saving the Young" QuestId="24623" TurnInName="Kijara" TurnInId="37969" X="-1546.085" Y="-5312.521" Z="8.107081" />

		<PickUp QuestName="Young and Vicious" QuestId="24626" GiverName="Kijara" GiverId="37969" X="-1546.085" Y="-5312.521" Z="8.107081" />
		<While Condition="DoQuest(24626)" >
			<Code File="InteractWith" MobId="38002" Range="19" CollectionDistance="200" NonCompeteDistance="0" InteractByUsingItemId="50053" QuestId="24626" X="-1550.001" Y="-5299.74" Z="8.991699" TerminateWhen="Me.InVehicle" />
			<Code File="NoCombatMoveTo" QuestId="24626" X="-1305.38" Y="-5449.925" Z="14.65966" TerminateWhen="!Me.InVehicle" />
		</While>
		<TurnIn QuestName="Young and Vicious" QuestId="24626" TurnInName="Moraya" TurnInId="38005" X="-1294.191" Y="-5521.454" Z="20.76723" />

		<PickUp QuestName="Breaking the Line" QuestId="25035" GiverName="Tortunga" GiverId="38440" X="-1327.71" Y="-5553.412" Z="21.52649" />
		<Code File="InteractWith" MobId="38989" GossipOptions="1" WaitTime="35000" X="-1331.409" Y="-5555.198" Z="21.4374" TerminateWhen="!HasQuest(25035) &amp;&amp; Unit(38989) == null" />
		<Code File="WaitTimer" WaitTime="40000" TerminateWhen="!Me.InVehicle" />
		<TurnIn QuestName="Breaking the Line" QuestId="25035" TurnInName="Morakki" TurnInId="38442" X="-805.5458" Y="-5554.75" Z="4.603838" />

		<PickUp QuestName="No More Mercy" QuestId="24812" GiverName="Morakki" GiverId="38442" X="-805.5458" Y="-5554.75" Z="4.603838" />
		<PickUp QuestName="Territorial Fetish" QuestId="24813" GiverName="Morakki" GiverId="38442" X="-805.5458" Y="-5554.75" Z="4.603838" />

		<Code File="InteractWith" MobId="202113" CollectionDistance="200" InteractByUsingItemId="52065" QuestId="24813" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-745.6462" Y="-5596.807" Z="-8.219222" />
				<Hotspot X="-663.8286" Y="-5651.184" Z="-25.14141" />
			</HuntingGrounds>
		</Code>

		<Code File="KillUntilComplete" MobIds="38300, 38301" QuestId="24812" >
			<HuntingGrounds>
				<Hotspot X="-745.6462" Y="-5596.807" Z="-8.219222" />
				<Hotspot X="-663.8286" Y="-5651.184" Z="-25.14141" />
			</HuntingGrounds>
		</Code>

		<DisableBehavior Name="Vendor" /> <!-- If we vendor, the bot may get confused and try to turn in the quests below to the wrong Morakki NPC -->

		<TurnIn QuestName="No More Mercy" QuestId="24812" TurnInName="Morakki" TurnInId="38442" X="-799.3029" Y="-5557.472" Z="4.405144" />
		<TurnIn QuestName="Territorial Fetish" QuestId="24813" TurnInName="Morakki" TurnInId="38442" X="-799.3029" Y="-5557.472" Z="4.405144" />

		<EnableBehavior Name="Vendor" />

		<Checkpoint Level="5.5" /> <!-- Would be 5, but we don't want to level up inside of the cave and not turn in quests -->

		<Code File="LoadProfile" ProfileName="..\Kalimdor\Durotar.xml" RememberProfile="true" />

	</QuestOrder>
</HBProfile>