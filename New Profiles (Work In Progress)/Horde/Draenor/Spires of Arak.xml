<HBProfile xsi:noNamespaceSchemaLocation="../../Schemas/EchoQuestingSchema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- Original contribution by EchoTiger -->
	<Name>Spires of Arak ($Rev: 6041 $)</Name>

	<DefaultNavType>Fly</DefaultNavType>

	<MinDurability>0.3</MinDurability>
	<MinFreeBagSlots>3</MinFreeBagSlots>

	<SellGrey>true</SellGrey>
	<SellWhite>true</SellWhite>
	<SellGreen>true</SellGreen>
	<SellBlue>true</SellBlue>
	<SellPurple>false</SellPurple>

	<MailGrey>false</MailGrey>
	<MailWhite>true</MailWhite>
	<MailGreen>true</MailGreen>
	<MailBlue>true</MailBlue>
	<MailPurple>true</MailPurple>

	<TargetElites>true</TargetElites>

	<AvoidMobs>
	</AvoidMobs>

	<Mailboxes>
	</Mailboxes>

	<Vendors>
	</Vendors>

	<Blackspots>
	</Blackspots>

	<Blacklist>
	</Blacklist>

	<QuestOrder IgnoreCheckpoints="false" ContinuallySkipToCheckpoints="true" >
		<If Condition="Me.IsAlliance" >
			<Code File="LoadProfile" ProfileName="..\..\Alliance\1-58 Autoloader.xml" RememberProfile="true" />
		</If>
		<!-- RunCode Methods -->
			<!-- <Code File="RunCode">
			<![CDATA[
				Bots.Professionbuddy.PBLog.Log(System.Windows.Media.Colors.MediumPurple, "> [Profile Initialization Status] ", System.Windows.Media.Colors.CornflowerBlue, "\n     Auto-Looting	:: Enabled\n     Looting	:: Enabled\n     Game Addons	:: Disabled");
				Lua.DoString("SetCVar('AutoLootDefault', 1);");
				CharacterSettings.Instance.LootMobs = true;
				CharacterSettings.Instance.Save();
				Lua.DoString("for i=1,GetNumAddOns() do local relo=false if IsAddOnLoaded(i) then relo=true DisableAddOn(i) end if relo then relo=nil ReloadUI() end end");
				await Coroutine.Sleep(1500);
				Logging.Write(System.Windows.Media.Colors.MediumPurple, "> [Ready to bot!]");
			]]>
			</Code> -->
			<Code File="RunCode" Type="Definition">
				<![CDATA[
						bool DoQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (HasQuest(questId) && !IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool NeedsQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (!HasQuest(questId) && !IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool NeedsBreadcrumbQuest(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (IsQuestCompleted(questId)) return false;
							}
							return true;
						}
						bool QuestDone(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								if (HasQuest(questId) && IsQuestCompleted(questId)) return true;
							}
							return false;
						}
						bool QuestFlaggedCompleted(params uint[] questIds)
						{
							foreach (var questId in questIds)
							{
								return Lua.GetReturnVal<bool>($"return IsQuestFlaggedCompleted({questId});", 0);
							}
							return false;
						}
						async Task SkipCutscene(int preWait = 3000, int postWait = 3000)
						{
					// Add detection of cutscene here.
							await Coroutine.Sleep(preWait);
					// Test and improve the working method.
							Lua.DoString("MovieFrame:StopMovie(); CinematicFrame_CancelCinematic(); StopCinematic();");
							await Coroutine.Sleep(postWait);
						}
					]]>
			</Code>
		<!-- END RunCode Methods -->

		<!-- Hooks -->
			<Code File="RunCode" Type="Definition">
				<![CDATA[ 
					IEnumerable<WoWItem> GetExtraConsumables()
					{
						uint foodCount = 0;
						uint drinkCount = 0;
						// Skip conjured and buff comsumables.
				
						var extraConsumables = (from item in Me.BagItems
										   where item != null && item.ItemInfo != null
										   let isFood = Consumable.IsFood(item.ItemInfo)
										   let isDrink = Consumable.IsDrink(item.ItemInfo)
										   where (isFood || isDrink) && item.ItemInfo.SellPrice > 0 && item.Effects.Count == 1 && item.ItemInfo.RequiredLevel < Me.Level - 10                    
										   select item).ToList();
				
				
						var extraPotions = Me.BagItems
							.Where(c => c != null && c.IsValid && c.ItemInfo != null && c.ItemInfo.SellPrice > 0 && c.Effects.Count == 1
								&& (c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Potion
								|| c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Elixir
								|| c.ItemInfo.ConsumableClass == WoWItemConsumableClass.Flask)
								&& c.ItemInfo.RequiredLevel < Me.Level - 20);
				
						extraConsumables.AddRange(extraPotions);
						return extraConsumables;
					}
					 
					async Task SellExtraConsumables()
					{
						Logging.Write("Selling items in GetExtraConsumables()");
						foreach (var item in GetExtraConsumables())
						{
							Logging.Write("Selling {0}.", item.Name);
							item.UseContainerItem();
							await Coroutine.Sleep(1337);
						}
					}
				]]>
			</Code>
			<Code File="Hooks\DoWhen" AllowExecutionWhileNotAlive="false"  AllowUseWhileMounted="true" ActivityName="SellExtraConsumables" UseWhen="MerchantFrame.Instance.IsVisible &amp;&amp; GetExtraConsumables().Any()" >
				<Code File="RunCode" Code="await SellExtraConsumables();"/>
			</Code>
		<!-- END Hooks -->

		<While Condition="NeedsQuest(36951)" >
			<Code File="RunCode" Code="
				if (Unit(79407) != null) return;
				await CommonCoroutines.LandAndDismount();
				Me.BagItems.FirstOrDefault(x =&gt; x.Entry == 110560).Use();
				await Coroutine.Sleep(500);
				await Coroutine.Wait(7000, () =&gt; !Me.IsCasting);
			" />
			<Code File="Misc\RunLua" WaitTime="1000" Lua="if not EncounterJournal then EncounterJournal_LoadUI() end ToggleFrame(EncounterJournal); EncounterJournalSuggestFrame.Suggestion1.button:Click();" />
			<Code File="RunCode" Code="QuestFrame.Instance.AcceptQuest();" />
			<Code File="WaitTimer" WaitTime="1000" />
		</While>

		<While Condition="HasQuest(36951) &amp;&amp; Unit(79407) != null" >
			<Code File="InteractWith" MobId="79407" GossipOptions="2" PreInteractMountStrategy="Dismount" X="5581.141" Y="4566.74" Z="136.3746" TerminateWhen="Unit(79407) == null" />
		</While>

		<If Condition="HasQuest(36951)" >
			<TurnIn QuestName="Arakkoa Exodus" QuestId="36951" TurnInName="Azik" TurnInId="79539" X="655.1141" Y="2387.757" Z="203.7569" />
		</If>

		<PickUp QuestName="The Shadows of Skettis" QuestId="34655" GiverName="Azik" GiverId="79539" X="655.1141" Y="2387.757" Z="203.7569" />
		<Code File="InteractWith" MobId="79519" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="34655" QuestObjectiveIndex="1" X="858.4827" Y="2036.492" Z="179.6153" />
		<TurnIn QuestName="The Shadows of Skettis" QuestId="34655" TurnInName="Reshad" TurnInId="79519" X="858.4827" Y="2036.492" Z="179.6153" />

		<PickUp QuestName="Hidden in Plain Sight" QuestId="34656" GiverName="Reshad" GiverId="79519" X="858.4827" Y="2036.492" Z="179.6153" />
		<PickUp QuestName="Adherents of the Sun God" QuestId="34657" GiverName="Reshad" GiverId="79519" X="858.4827" Y="2036.492" Z="179.6153" />

		<Code File="InteractWith" MobId="230568" IgnoreLoSToTarget="true" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="34656" QuestObjectiveIndex="2" X="774.4047" Y="1958.164" Z="174.1314" />
		<Code File="InteractWith" MobId="230529" IgnoreLoSToTarget="true" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="34656" QuestObjectiveIndex="1" X="725.8224" Y="2180.766" Z="157.2528" />

		<Code File="KillUntilComplete" MobId="79598" QuestId="34657" >
			<HuntingGrounds>
				<Hotspot X="733.6532" Y="2148.29" Z="157.1929" />
				<Hotspot X="812.3875" Y="2049.503" Z="167.5723" />
				<Hotspot X="791.1584" Y="1957.102" Z="174.1313" />
			</HuntingGrounds>
		</Code>

		<TurnIn QuestName="Hidden in Plain Sight" QuestId="34656" TurnInName="Reshad" TurnInId="79519" X="857.3716" Y="2037.078" Z="179.616" />
		<TurnIn QuestName="Adherents of the Sun God" QuestId="34657" TurnInName="Reshad" TurnInId="79519" X="857.3716" Y="2037.078" Z="179.616" />

		<PickUp QuestName="Orders From On High" QuestId="34658" GiverName="Reshad" GiverId="79519" X="857.3716" Y="2037.078" Z="179.616" />
		<While Condition="DoQuest(34658)" >
			<CustomBehavior File="Hooks\Avoid" AvoidName="SolarZone" Command="Add" ObjectType="AreaTrigger" ObjectId="6622" Radius="5" />
			<Code File="KillUntilComplete" MobId="79516" QuestId="34658" X="772.8386" Y="1898.073" Z="188.3338" />
			<CustomBehavior File="Hooks\Avoid" AvoidName="SolarZone" Command="Remove" />
		</While>
		<TurnIn QuestName="Orders From On High" QuestId="34658" TurnInName="Reshad" TurnInId="79519" X="644.9515" Y="1928.788" Z="141.576" />

		<PickUp QuestName="The Crone" QuestId="34659" GiverName="Reshad" GiverId="79519" X="644.9515" Y="1928.788" Z="141.576" />
		<Code File="InteractWith" MobId="79890" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="34659" QuestObjectiveIndex="1" X="119.9163" Y="1553.551" Z="-1.781598" />
		<TurnIn QuestName="The Crone" QuestId="34659" TurnInName="Ornekka" TurnInId="79890" X="119.7187" Y="1551.155" Z="-1.781804" />

		<PickUp QuestName="A Charming Deception" QuestId="34756" GiverName="Ornekka" GiverId="79890" X="119.7187" Y="1551.155" Z="-1.781804" />
		<PickUp QuestName="All Due Respect" QuestId="35636" GiverName="Ornekka" GiverId="79890" X="119.7187" Y="1551.155" Z="-1.781804" />

		<PickUp QuestName="Echo Hunters" QuestId="34805" GiverName="Reshad" GiverId="79519" X="119.027" Y="1556.17" Z="-1.781804" />

		<Code File="InteractWith" MobId="80047" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35636" QuestObjectiveIndex="1" X="-86.15759" Y="1631.85" Z="-5.85509" />
		<Code File="InteractWith" MobId="233073" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="30" QuestId="35636" QuestObjectiveIndex="2" X="-99.55599" Y="1647.25" Z="-4.999922" />

		<TurnIn QuestName="All Due Respect" QuestId="35636" TurnInName="Reshad" TurnInId="82621" X="-96.92048" Y="1635.05" Z="-5.855151" />
		<PickUp QuestName="Syth&apos;s Secret" QuestId="35668" GiverName="Reshad" GiverId="82621" X="-96.92048" Y="1635.05" Z="-5.855151" />

		<Code File="InteractWith" MobId="230714" CollectionDistance="200" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" QuestId="34756" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="35.44617" Y="1591.769" Z="-11.23843" />
				<Hotspot X="-120.1487" Y="1605.849" Z="-3.941732" />
				<Hotspot X="-231.8441" Y="1711.404" Z="9.438479" />
			</HuntingGrounds>
		</Code>

		<Code File="KillUntilComplete" MobId="79895" QuestId="34805" >
			<HuntingGrounds>
				<Hotspot X="35.44617" Y="1591.769" Z="-11.23843" />
				<Hotspot X="-120.1487" Y="1605.849" Z="-3.941732" />
				<Hotspot X="-231.8441" Y="1711.404" Z="9.438479" />
			</HuntingGrounds>
		</Code>

		<While Condition="DoQuest(35668)" >
			<CustomBehavior File="Hooks\Avoid" AvoidName="Chakram" Command="Add" ObjectType="AreaTrigger" ObjectId="165358" Radius="10" />
			<CustomBehavior File="Hooks\Avoid" AvoidName="Whirl" Command="Add" ObjectType="AreaTrigger" ObjectId="6580" Radius="8" />
			<Code File="KillUntilComplete" MobId="82623" QuestId="35668" X="-340.6552" Y="1745.456" Z="-22.532" />
			<CustomBehavior File="Hooks\Avoid" AvoidName="Chakram" Command="Remove" />
			<CustomBehavior File="Hooks\Avoid" AvoidName="Whirl" Command="Remove" />
		</While>

		<TurnIn QuestName="A Charming Deception" QuestId="34756" TurnInName="Reshad" TurnInId="81770" X="-412.4" Y="1741.096" Z="45.33718" />
		<TurnIn QuestName="Syth&apos;s Secret" QuestId="35668" TurnInName="Reshad" TurnInId="81770" X="-412.4" Y="1741.096" Z="45.33718" />
		<TurnIn QuestName="Echo Hunters" QuestId="34805" TurnInName="Reshad" TurnInId="81770" X="-412.4" Y="1741.096" Z="45.33718" />

		<PickUp QuestName="A Gathering of Shadows" QuestId="35671" GiverName="Reshad" GiverId="81770" X="-414.4272" Y="1741.5" Z="45.35337" />
		<While Condition="DoQuest(35671)" >
			<Code File="WaitTimer" WaitTime="35000" QuestId="35671" />
		</While>
		<TurnIn QuestName="A Gathering of Shadows" QuestId="35671" TurnInName="Shadow-Sage Iskar" TurnInId="82720" X="-458.5011" Y="1859.715" Z="41.12453" />

		<!-- HORDE STUFF BELOW -->

		<PickUp QuestName="One of Our Own" QuestId="35272" GiverName="Shadow Hunter Ukambe" GiverId="81890" X="-489.8721" Y="1894.692" Z="41.28085" />
		<Code File="InteractWith" MobId="80153" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35272" QuestObjectiveIndex="1" X="-462.7388" Y="1862.863" Z="41.12225" />
		<TurnIn QuestName="One of Our Own" QuestId="35272" TurnInName="Shadow Hunter Ukambe" TurnInId="81890" X="-489.8877" Y="1896.364" Z="41.28014" />

		<PickUp QuestName="Inspecting the Troops" QuestId="35275" GiverName="Shadow Hunter Ukambe" GiverId="81890" X="-489.8877" Y="1896.364" Z="41.28014" />
		<TurnIn QuestName="Inspecting the Troops" QuestId="35275" TurnInName="Shadow Hunter Ukambe" TurnInId="81913" X="-397.4308" Y="2249.264" Z="26.13542" />

		<PickUp QuestName="Orders, Commander?" QuestId="35277" GiverName="Taskmaster Gornek" GiverId="81920" X="-375.8674" Y="2246.527" Z="26.1317" />
		<While Condition="DoQuest(35277)" >
			<Code File="Misc\RunLua" Lua="LoadAddOn(&quot;Blizzard_QuestChoice&quot;);" />
			<If Condition="!Lua.GetReturnVal&lt;bool&gt;(&quot;return QuestChoiceFrame:IsVisible()&quot;, 0)" >
				<Code File="InteractWith" MobId="232062" NonCompeteDistance="0" InteractBlacklistTimeInSeconds="1" QuestId="35277" X="-371.5568" Y="2246.001" Z="26.1317" />
			</If>
			<Code File="Misc\RunLua" QuestId="35277" Lua="QuestChoiceFrameOption1.OptionButton:Click()" WaitTime="1000" />
			<Code File="RunCode" Code="await SkipCutscene(1000);" />
		</While>
		<TurnIn QuestName="Orders, Commander?" QuestId="35277" TurnInName="Taskmaster Gornek" TurnInId="81920" X="-374.4991" Y="2250.201" Z="26.13193" />

		<PickUp QuestName="Befriending the Locals" QuestId="37326" GiverName="Taskmaster Gornek" GiverId="81920" X="-374.4991" Y="2250.201" Z="26.13193" />
		<PickUp QuestName="What&apos;s Theirs is Ours" QuestId="35295" GiverName="Shadow Hunter Ukambe" GiverId="81959" X="-370.0058" Y="2244.692" Z="26.13708" />

		<PickUp QuestName="Return to Veil Terokk" QuestId="35611" GiverName="Percy" GiverId="79748" X="-391.608" Y="2250.871" Z="26.13163" />
		<TurnIn QuestName="What&apos;s Theirs is Ours" QuestId="35295" TurnInName="Shadow Hunter Ukambe" TurnInId="81961" X="-589.5215" Y="2307.393" Z="27.72844" />

		<PickUp QuestName="I See Dead People" QuestId="35322" GiverName="Shadow Hunter Ukambe" GiverId="81961" X="-589.5215" Y="2307.393" Z="27.72844" />
		<Code File="KillUntilComplete" MobIds="82055, 82083" QuestId="35322" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-586.2755" Y="2372.315" Z="33.41565" />
				<Hotspot X="-641.8588" Y="2473.061" Z="32.56297" />
			</HuntingGrounds>
		</Code>
		<Code File="InteractWith" MobId="82065" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35322" QuestObjectiveIndex="2" X="-593.3799" Y="2314.449" Z="28.24722" />
		<TurnIn QuestName="I See Dead People" QuestId="35322" TurnInName="Bryan Finn" TurnInId="82100" X="-589.4871" Y="2319.456" Z="29.26233" />

		<PickUp QuestName="A Parting Favor" QuestId="35339" GiverName="Bryan Finn" GiverId="82100" X="-589.4871" Y="2319.456" Z="29.26233" />
		<Code File="KillUntilComplete" MobIds="82028, 82029, 82143" QuestId="35339" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-654.9741" Y="2340.569" Z="30.52326" />
				<Hotspot X="-730.1157" Y="2436.36" Z="35.12841" />
			</HuntingGrounds>
		</Code>
		<Code File="InteractWith" MobId="82110" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35339" QuestObjectiveIndex="2" X="-677.0351" Y="2397.637" Z="40.28727" />

		<TurnIn QuestName="A Parting Favor" QuestId="35339" TurnInName="Alice Finn" TurnInId="82124" X="-677.0351" Y="2397.637" Z="40.28727" />
		<TurnIn QuestName="A Parting Favor" QuestId="35339" TurnInName="Alice Finn" TurnInId="82124" X="-677.0351" Y="2397.637" Z="40.28727" />

		<PickUp QuestName="A Piece of the Puzzle" QuestId="35353" GiverName="Alice Finn" GiverId="82124" X="-677.0351" Y="2397.637" Z="40.28727" />
		<Code File="KillUntilComplete" MobId="82136" QuestId="35353" X="-678.0024" Y="2399.368" Z="20.69294" />
		<TurnIn QuestName="A Piece of the Puzzle" QuestId="35353" TurnInName="Alice Finn" TurnInId="82126" X="-669.1524" Y="2405.447" Z="27.45271" />

		<PickUp QuestName="Second in Command" QuestId="35380" GiverName="Alice Finn" GiverId="82126" X="-669.1524" Y="2405.447" Z="27.45271" />
		<TurnIn QuestName="Second in Command" QuestId="35380" TurnInName="Sir Edward" TurnInId="82194" X="-787.6193" Y="2400.717" Z="37.83532" />
		<PickUp QuestName="Punishable by Death" QuestId="35407" GiverName="Sir Edward" GiverId="82194" X="-787.5815" Y="2401.246" Z="37.83532" />
		<PickUp QuestName="Prime the Cannons" QuestId="35408" GiverName="Lady Claudia" GiverId="82212" X="-789.7053" Y="2403.218" Z="37.83532" />

		<Code File="InteractWith" MobIds="232360, 232361" CollectionDistance="200" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" QuestId="35408" QuestObjectiveIndex="1" X="-753.6218" Y="2444.173" Z="35.34811" />
		<Code File="InteractWith" MobId="232401" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35408" QuestObjectiveIndex="2" X="-774.5093" Y="2469.867" Z="39.64412" />

		<Code File="KillUntilComplete" MobIds="82230, 82232, 82235, 82247" QuestId="35407" >
			<HuntingGrounds>
				<Hotspot X="-774.5093" Y="2469.867" Z="39.64412" />
				<Hotspot X="-773.2551" Y="2380.381" Z="36.64181" />
				<Hotspot X="-758.0767" Y="2491.536" Z="37.03808" />
			</HuntingGrounds>
		</Code>

		<If Condition="!IsQuestCompleted(36864)" > <!-- Horde only -->
			<Code File="InteractWith" MobId="86597" NonCompeteDistance="0" X="3244.91" Y="1587.53" Z="162.282" TerminateWhen="IsQuestCompleted(36864)" />
			<Code File="RunCode" Code="QuestFrame.Instance.CompleteQuest();" />
		</If>

		<TurnIn QuestName="Punishable by Death" QuestId="35407" TurnInName="Sir Edward" TurnInId="82194" X="-787.9829" Y="2401.58" Z="37.83512" />
		<TurnIn QuestName="Prime the Cannons" QuestId="35408" TurnInName="Lady Claudia" TurnInId="82212" X="-788.6638" Y="2402.173" Z="37.83512" />

		<PickUp QuestName="Admiral Taylor" QuestId="36183" GiverName="Lady Claudia" GiverId="82278" X="-788.6638" Y="2402.173" Z="37.83512" />
		<While Condition="!IsQuestCompleted(36183)" >
			<!-- This mess below is copied from the old profiles,  come back to it and clean it up later -->
			<If Condition="!IsQuestCompleted(36183)">
				<CustomBehavior File="AbandonQuest" QuestId="36183" Type="All" />
			</If>
			<MoveTo X="-792.7222" Y="2399.188" Z="37.83524" />
			<If Condition="Unit(82293) == null" >
				<PickUp QuestName="Admiral Taylor" QuestId="36183" GiverName="Lady Claudia" GiverId="82278" X="-792.7222" Y="2399.188" Z="37.83524" />
			</If>
			<PickUp QuestName="Admiral Taylor" QuestId="36183" GiverName="Lady Claudia" GiverId="82293" X="-792.7222" Y="2399.188" Z="37.83524" />
			<If Condition="HasQuest(36183)" >
				<MoveTo X="-911.7457" Y="2449.228" Z="31.1776" />
				<CustomBehavior File="ForcedDismount" />
				<UseMount Value="false" />
				<CustomBehavior File="WaitTimer" WaitTime="20000" QuestId="36183" />
				<CustomBehavior File="InteractWith" MobId="82314" MobState="Alive" PreInteractMountStrategy="Dismount" Range="6" WaitForNpcs="false" QuestId="36183" QuestObjectiveIndex="2" X="-911.7457" Y="2449.228" Z="31.1776" />
				<MoveTo X="-954.7072" Y="2468.633" Z="37.91863" />
				<CustomBehavior File="KillUntilComplete" MobIds="82320, 82314" WaitForNpcs="false" QuestId="36183" QuestObjectiveIndex="3" X="-933.2177" Y="2449.947" Z="31.59137" />
				<CustomBehavior File="WaitTimer" WaitTime="30000" QuestId="36183" />
				<CustomBehavior File="InteractWith" MobIds="82314" X="-917.3248" Y="2449.913" Z="31.18384" MobState="Alive" QuestId="36183" TerminateWhen="Object(82314) == null" />
				<UseMount Value="true" />
			</If>
		</While>
		<TurnIn QuestName="Admiral Taylor" QuestId="36183" TurnInName="Admiral Taylor" TurnInId="82375" X="-917.528" Y="2449.927" Z="31.18376" />

		<PickUp QuestName="Surviving in a Savage Land" QuestId="35550" GiverName="Shadow Hunter Ukambe" GiverId="82402" X="-911.498" Y="2448.304" Z="31.17606" />

		<While Condition="!QuestFlaggedCompleted(35649)" >
			<Code File="KillUntilComplete" MobId="85219" X="-524.3935" Y="2717.906" Z="2.129306" TerminateWhen="IsObjectiveComplete(1, 35649) ? true : QuestFlaggedCompleted(35649)" />
			<Code File="InteractWith" MobId="233035" Range="4" NumOfTimes="9" CollectionDistance="200" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" TerminateWhen="IsObjectiveComplete(2, 35649) ? true : QuestFlaggedCompleted(35649)" >
				<HuntingGrounds>
					<Hotspot X="-491.4117" Y="2734.751" Z="-0.2433954" />
					<Hotspot X="-488.9155" Y="2599.563" Z="0.01457006" />
					<Hotspot X="-359.9386" Y="2637.398" Z="1.190644" />
					<Hotspot X="-362.7526" Y="2632.264" Z="1.066068" />
				</HuntingGrounds>
			</Code>
			<Code File="KillUntilComplete" TerminateWhen="QuestFlaggedCompleted(35649)" >
				<HuntingGrounds>
					<Hotspot X="-388.4003" Y="2707.958" Z="-0.5324543" />
					<Hotspot X="-258.2838" Y="2628.593" Z="4.297786" />
					<Hotspot X="-470.0223" Y="2540.714" Z="-0.5697199" />
				</HuntingGrounds>
				<PursuitList>
					<PursueUnit Id="85429" PursueWhen="!IsObjectiveComplete(3, 35649)" />
					<PursueUnit Id="82130" PursueWhen="!IsObjectiveComplete(4, 35649)" /> 
					<PursueUnit Id="85214" PursueWhen="!IsObjectiveComplete(4, 35649)" />
					<PursueUnit Id="85461" PursueWhen="!IsObjectiveComplete(4, 35649)" />
				</PursuitList>
			</Code>
		</While>

		<!-- Not worth it.
		Takes too long, mobs are too strong and over populated WITH elites mobs as well (wtf?), trigger area isn't designed right,  some of unescapable stuck places (even by player).
		<While Condition="!QuestFlaggedCompleted(36792)" >
			<Code File="KillUntilComplete" MobId="86294" TerminateWhen="IsObjectiveComplete(2, 36792) ? true : QuestFlaggedCompleted(36792)" >
				<HuntingGrounds>
					<Hotspot X="24.8127" Y="2819.898" Z="44.28384" />
					<Hotspot X="88.20568" Y="2888.391" Z="44.26399" />
				</HuntingGrounds>
			</Code>

			<Code File="KillUntilComplete" MobId="86455" X="156.637" Y="2834.457" Z="16.75046" TerminateWhen="IsObjectiveComplete(4, 36792) ? true : QuestFlaggedCompleted(36792)" />

			<Code File="InteractWith" MobId="86524" CollectionDistance="200" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" TerminateWhen="IsObjectiveComplete(3, 36792) ? true : QuestFlaggedCompleted(36792)" >
				<HuntingGrounds>
					<Hotspot X="99.63421" Y="2761.977" Z="64.01034" />
					<Hotspot X="208.3186" Y="2828.429" Z="80.87865" />
					<Hotspot X="273.9478" Y="2930.275" Z="83.20494" />
					<Hotspot X="212.1957" Y="2948.83" Z="83.1672" />
				</HuntingGrounds>
			</Code>

			<Code File="KillUntilComplete" MobId="86461" X="278.1785" Y="2850.17" Z="78.09664" TerminateWhen="IsObjectiveComplete(5, 36792) ? true : QuestFlaggedCompleted(36792)" />
			<Code File="KillUntilComplete" MobId="86482" X="298.8264" Y="2989.751" Z="135.6284" TerminateWhen="IsObjectiveComplete(6, 36792) ? true : QuestFlaggedCompleted(36792)" />

			<Code File="KillUntilComplete" MobIds="86285, 86296" TerminateWhen="IsObjectiveComplete(1, 36792) ? true : QuestFlaggedCompleted(36792)" >
				<HuntingGrounds>
					<Hotspot X="99.63421" Y="2761.977" Z="64.01034" />
					<Hotspot X="208.3186" Y="2828.429" Z="80.87865" />
					<Hotspot X="273.9478" Y="2930.275" Z="83.20494" />
					<Hotspot X="212.1957" Y="2948.83" Z="83.1672" />
				</HuntingGrounds>
			</Code>
		</While> -->

		<PickUp QuestName="Pinchwhistle Gearworks" QuestId="35620" GiverName="Scout Cel" GiverId="85566" X="-392.2903" Y="2253.169" Z="26.13275" />
		<TurnIn QuestName="Surviving in a Savage Land" QuestId="35550" TurnInName="Taskmaster Gornek" TurnInId="81920" X="-376.0883" Y="2247.11" Z="26.13115" />

		<Code File="InteractWith" MobId="82612" GossipOptions="1" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35620" QuestObjectiveIndex="1" X="-367.0536" Y="2288.125" Z="33.93559" TerminateWhen="Unit(82612) == null" />

		<TurnIn QuestName="Pinchwhistle Gearworks" QuestId="35620" TurnInName="Kimzee Pinchwhistle" TurnInId="81109" X="-1559.259" Y="957.3895" Z="7.78731" />
		<PickUp QuestName="Defungination" QuestId="35077" GiverName="Kimzee Pinchwhistle" GiverId="81109" X="-1559.259" Y="957.3895" Z="7.78731" />
		<PickUp QuestName="Spore-be-Gone" QuestId="35079" GiverName="Engineer Gazwitz" GiverId="81128" X="-1559.259" Y="957.3895" Z="7.78731" />
		<PickUp QuestName="Unwanted Pests" QuestId="36179" GiverName="Exterminator Lemmy" GiverId="85062" X="-1599.338" Y="890.8287" Z="-0.1236227" />

		<Code File="InteractWith" MobId="81288" Range="8" CollectionDistance="200" NonCompeteDistance="0" InteractByUsingItemId="112683" PreInteractMountStrategy="Dismount" QuestId="35077" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-1609.414" Y="845.4555" Z="-0.4377468" />
				<Hotspot X="-1654.04" Y="795.5356" Z="-0.5511128" />
				<Hotspot X="-1711.993" Y="847.8614" Z="-0.4156007" />
			</HuntingGrounds>
		</Code>

		<Code File="InteractWith" MobId="81135" CollectionDistance="200" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" QuestId="35079" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-1609.414" Y="845.4555" Z="-0.4377468" />
				<Hotspot X="-1654.04" Y="795.5356" Z="-0.5511128" />
				<Hotspot X="-1711.993" Y="847.8614" Z="-0.4156007" />
			</HuntingGrounds>
		</Code>

		<Code File="KillUntilComplete" MobId="81138" QuestId="36179" >
			<HuntingGrounds>
				<Hotspot X="-1609.414" Y="845.4555" Z="-0.4377468" />
				<Hotspot X="-1654.04" Y="795.5356" Z="-0.5511128" />
				<Hotspot X="-1711.993" Y="847.8614" Z="-0.4156007" />
			</HuntingGrounds>
		</Code>

		<TurnIn QuestName="Spore-be-Gone" QuestId="35079" TurnInName="Engineer Gazwitz" TurnInId="81128" X="-1560.861" Y="956.1122" Z="8.047243" />
		<TurnIn QuestName="Unwanted Pests" QuestId="36179" TurnInName="Engineer Gazwitz" TurnInId="81128" X="-1560.861" Y="956.1122" Z="8.047243" />
		<TurnIn QuestName="Defungination" QuestId="35077" TurnInName="Kimzee Pinchwhistle" TurnInId="81109" X="-1560.861" Y="956.1122" Z="8.047243" />
		<PickUp QuestName="The Mother Lode" QuestId="35080" GiverName="Kimzee Pinchwhistle" GiverId="81109" X="-1560.861" Y="956.1122" Z="8.047243" />
		<TurnIn QuestName="The Mother Lode" QuestId="35080" TurnInName="Kimzee Pinchwhistle" TurnInId="81773" X="-1813.689" Y="1099.493" Z="45.12279" />
		<PickUp QuestName="Getting the Crew Back Together" QuestId="35082" GiverName="Kimzee Pinchwhistle" GiverId="81773" X="-1813.689" Y="1099.493" Z="45.12279" />
		<PickUp QuestName="Clearing Out Before Cleaning Up" QuestId="35081" GiverName="Engineer Gazwitz" GiverId="81784" X="-1814.349" Y="1099.603" Z="45.16587" />

		<Code File="InteractWith" MobIds="81131, 89209" CollectionDistance="200" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" QuestId="35082" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-1868.269" Y="1079.512" Z="33.98903" />
				<Hotspot X="-1963.849" Y="1033.965" Z="4.424893" />
			</HuntingGrounds>
		</Code>

		<Code File="KillUntilComplete" MobId="81168" QuestId="35081" >
			<HuntingGrounds>
				<Hotspot X="-1868.269" Y="1079.512" Z="33.98903" />
				<Hotspot X="-1963.849" Y="1033.965" Z="4.424893" />
			</HuntingGrounds>
		</Code>

		<TurnIn QuestName="Getting the Crew Back Together" QuestId="35082" TurnInName="Kimzee Pinchwhistle" TurnInId="81773" X="-1818.171" Y="1097.98" Z="45.29502" />
		<TurnIn QuestName="Clearing Out Before Cleaning Up" QuestId="35081" TurnInName="Engineer Gazwitz" TurnInId="81784" X="-1818.171" Y="1097.98" Z="45.29502" />
		<PickUp QuestName="Follow that Hotrod!" QuestId="35285" GiverName="Engineer Gazwitz" GiverId="81784" X="-1818.171" Y="1097.98" Z="45.29502" />
		<TurnIn QuestName="Follow that Hotrod!" QuestId="35285" TurnInName="Kimzee Pinchwhistle" TurnInId="81972" X="-2345.944" Y="1139.179" Z="20.18333" />
		<PickUp QuestName="The Right Parts for the Job" QuestId="35090" GiverName="Kimzee Pinchwhistle" GiverId="81972" X="-2345.944" Y="1139.179" Z="20.18333" />
		<PickUp QuestName="Skimming Off the Top" QuestId="35089" GiverName="Kimzee Pinchwhistle" GiverId="81972" X="-2345.944" Y="1139.179" Z="20.18333" />
		<PickUp QuestName="Field Trial" QuestId="36384" GiverName="Krixel Pinchwhistle" GiverId="81443" X="-2342.623" Y="1138.71" Z="20.04001" />

		<Code File="InteractWith" MobIds="81183, 81184" MobState="Alive" CollectionDistance="200" InteractByUsingItemId="115475" PreInteractMountStrategy="Dismount" QuestId="36384" QuestObjectiveIndex="1" >
			<HuntingGrounds>
				<Hotspot X="-2269.218" Y="1216.339" Z="3.140486" />
				<Hotspot X="-2147.87" Y="1178.631" Z="15.66379" />
			</HuntingGrounds>
		</Code>

		<While Condition="DoQuest(35090)" >
			<Code File="InteractWith" MobId="81370" WaitTime="5000" CollectionDistance="200" NonCompeteDistance="0" InteractByUsingItemId="112698" PreInteractMountStrategy="Dismount" QuestId="35090" QuestObjectiveIndex="1" TerminateWhen="Object(231811, u =&gt; u.DistanceSqr &lt; 60f*60f) != null" >
				<HuntingGrounds>
					<Hotspot X="-2189.96" Y="1029.272" Z="1.783616" />
					<Hotspot X="-2223.185" Y="1102.56" Z="2.143903" />
					<Hotspot X="-2261.598" Y="1158.737" Z="0.002654999" />
				</HuntingGrounds>
			</Code>
			<Code File="InteractWith" MobId="231811" CollectionDistance="60" WaitForNpcs="false" NonCompeteDistance="0" InteractByLooting="true" PreInteractMountStrategy="Dismount" QuestId="35090" QuestObjectiveIndex="1" />
		</While>

		<TurnIn QuestName="Field Trial" QuestId="36384" TurnInName="Krixel Pinchwhistle" TurnInId="81443" X="-2343.181" Y="1137.622" Z="20.54695" />
		<TurnIn QuestName="The Right Parts for the Job" QuestId="35090" TurnInName="Kimzee Pinchwhistle" TurnInId="81978" X="-2365.9" Y="1119.458" Z="27.35669" />
		<TurnIn QuestName="Skimming Off the Top" QuestId="35089" TurnInName="Kimzee Pinchwhistle" TurnInId="81978" X="-2365.9" Y="1119.458" Z="27.35669" />
		<PickUp QuestName="Sporicide" QuestId="35091" GiverName="Kimzee Pinchwhistle" GiverId="81978" X="-2365.9" Y="1119.458" Z="27.35669" />
		<PickUp QuestName="Preventing the Worst" QuestId="35211" GiverName="Krixel Pinchwhistle" GiverId="81443" X="-2343.931" Y="1138.319" Z="20.22108" />
		<PickUp QuestName="Curing With Force" QuestId="36428" GiverName="Krixel Pinchwhistle" GiverId="81443" X="-2343.931" Y="1138.319" Z="20.22108" />

		<While Condition="DoQuest(35211, 36428)" >
			<Code File="RunCode"><![CDATA[ TreeHooks.Instance.InsertHook("Questbot_Main", 0, _usegoblinSerum ?? (_usegoblinSerum = new  CommonBehaviors.Actions.ActionRunCoroutine(ctx => UseGoblinSerum()))); ]]></Code>
			<Code File="RunCode" Type="Definition" >
			<![CDATA[
				private Styx.TreeSharp.Composite _usegoblinSerum;
				private WoWItem refinedSerum = StyxWoW.Me.BagItems.FirstOrDefault(x => x.Entry == 115533);
				private async Task<bool> UseGoblinSerum()
				{
					if (!DoQuest(36428)) return false;
					if (refinedSerum == null || !refinedSerum.IsValid)
					{
						refinedSerum = StyxWoW.Me.BagItems.FirstOrDefault(x => x.Entry == 115533);
						return false;
					}
					if (Me.CurrentTarget == null || Me.CurrentTarget.IsDead || (Me.CurrentTarget.Entry != 81183 && Me.CurrentTarget.Entry != 81184 && Me.CurrentTarget.Entry != 85325)) return false;
					if (Me.CurrentTarget.HealthPercent <= 60) 
						Lua.DoString("PetPassiveMode();");
					if (Me.CurrentTarget.HealthPercent > 35) return false;

					SpellManager.StopCasting();
					refinedSerum.Use();

					await Coroutine.Sleep(1000);
					Lua.DoString("PetAssistMode();");


					return true;
				}
			]]>
			</Code>

			<Code File="InteractWith" MobIds="81632" CollectionDistance="200" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" QuestId="35211" QuestObjectiveIndex="1" X="-2282.637" Y="1277.855" Z="18.05057" />

			<Code File="KillUntilComplete" MobIds="81183, 81184, 85325" QuestId="36428" X="-2282.637" Y="1277.855" Z="18.05057" />

			<Code File="RunCode"><![CDATA[ TreeHooks.Instance.RemoveHook("Questbot_Main", _usegoblinSerum); ]]></Code>
		</While>

		<Code File="KillUntilComplete" MobId="82265" QuestId="35091" >
			<HuntingGrounds>
				<Hotspot X="-2372.084" Y="1277.784" Z="0.03775621" />
				<Hotspot X="-2400.033" Y="1252.115" Z="0.3097048" />
				<Hotspot X="-2440.332" Y="1202.682" Z="2.16461" />
				<Hotspot X="-2324.038" Y="1203.979" Z="2.865454" />
			</HuntingGrounds>
		</Code>

		<TurnIn QuestName="Preventing the Worst" QuestId="35211" TurnInName="Krixel Pinchwhistle" TurnInId="81443" X="-2343.08" Y="1138.236" Z="20.26954" />
		<TurnIn QuestName="Curing With Force" QuestId="36428" TurnInName="Krixel Pinchwhistle" TurnInId="81443" X="-2343.08" Y="1138.236" Z="20.26954" />
		<TurnIn QuestName="Sporicide" QuestId="35091" TurnInName="Kimzee Pinchwhistle" TurnInId="81978" X="-2364.495" Y="1120.609" Z="27.35663" />

		<PickUp QuestName="Flame On" QuestId="35298" GiverName="Krixel Pinchwhistle" GiverId="81443" X="-2344.049" Y="1137.668" Z="20.51455" />
		<While Condition="DoQuest(35298)" >
			<Code File="InteractWith" MobId="231910" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35298" QuestObjectiveIndex="1" X="-2344.049" Y="1137.668" Z="20.51455" />
			<Code File="InteractWith" MobId="81567" NonCompeteDistance="0" PreInteractMountStrategy="Dismount" InteractBlacklistTimeInSeconds="1" QuestId="35298" QuestObjectiveIndex="2" X="-2364.891" Y="1120.52" Z="27.35645" />
			<Code File="WaitTimer" WaitTime="45000" TerminateWhen="!Me.InVehicle" />
		</While>
		<TurnIn QuestName="Flame On" QuestId="35298" TurnInName="Kimzee Pinchwhistle" TurnInId="82468" X="-1556.453" Y="946.9135" Z="7.639382" />

		<If Condition="!IsQuestCompleted(36062)" >
			<Code File="InteractWith" MobId="82468" NonCompeteDistance="0" X="-1556.453" Y="946.9135" Z="7.639382" TerminateWhen="IsQuestCompleted(36062)" />
			<Code File="RunCode" Code="QuestFrame.Instance.CompleteQuest();" />
		</If>
























































































		
	</QuestOrder>
</HBProfile>