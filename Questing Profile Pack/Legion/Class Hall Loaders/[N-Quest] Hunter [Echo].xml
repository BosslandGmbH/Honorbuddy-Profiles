<HBProfile xsi:noNamespaceSchemaLocation="../../Schemas/QuestProfileSchema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- Original contribution by EchoTiger -->
	<Name>[N-Quest] Hunter Artifact Loader [Echo]</Name>

	<MinDurability>0.3</MinDurability>
	<MinFreeBagSlots>3</MinFreeBagSlots>

	<SellGrey>true</SellGrey>
	<SellWhite>true</SellWhite>
	<SellGreen>true</SellGreen>
	<SellBlue>true</SellBlue>
	<SellPurple>false</SellPurple>

	<MailGrey>false</MailGrey>
	<MailWhite>true</MailWhite>
	<MailGreen>true</MailGreen>
	<MailBlue>true</MailBlue>
	<MailPurple>true</MailPurple>

	<TargetElites>true</TargetElites>

	<AvoidMobs>
		<Mob Name="XXX" Entry="123" />
	</AvoidMobs>

	<Blackspots>
	</Blackspots>

	<Blacklist>
	</Blacklist>

	<Mailboxes> 
	</Mailboxes>

	<Vendors>
	</Vendors>

	<InitOrder>
		<!-- Perhaps add detection for loading the class hall if player hasn't unlocked this zone yet. -->
		<CustomBehavior File="Misc\RunLua" Lua="SetCVar('AutoLootDefault', 1)" />

		<CustomBehavior File="EnablePlugin" Names="Anti Drown" />
		<CustomBehavior File="EnablePlugin" Names="Refreshment Detection" />

		<CustomBehavior File="Misc\ProfileCompatibilityInfo" AllowBrokenAddOns="true" AllowBrokenPlugIns="true" />

		<LootMobs Value="true" />
		<TargetingDistance Value="45" /> <!-- Use LevelBot default -->
	</InitOrder>

	<QuestOrder> <!-- No checkpoints here. -->
		<!-- RunCode Methods -->
			<CustomBehavior File="RunCode" Type="Definition"><![CDATA[
					bool DoQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (HasQuest(questId) && !IsQuestCompleted(questId)) return true;
						}
						return false;
					}
					bool NeedsQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (!HasQuest(questId) && !IsQuestCompleted(questId)) return true;
						}
						return false;
					}
					bool NeedsBreadcrumbQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (IsQuestCompleted(questId)) return false;
						}
						return true;
					}
					bool QuestDone(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (HasQuest(questId) && IsQuestCompleted(questId)) return true;
						}
						return false;
					}
				]]>
			</CustomBehavior>
		<!-- END RunCode Methods -->

			<!-- Loc: Dalaran -->
			<PickUp QuestName="Needs of the Hunters" QuestId="40384" GiverName="Snowfeather" GiverId="100786" X="-832.1716" Y="4393.731" Z="737.6624" /> <!-- May be a bit slow to spawn after first entering Dalaran. -->
			<TurnIn QuestName="Needs of the Hunters" QuestId="40384" TurnInName="Emmarel Shadewarden" TurnInId="102478" X="-876.658" Y="4379.09" Z="739.1406" />

			<PickUp QuestName="The Hunter's Call" QuestId="41415" GiverName="Emmarel Shadewarden" GiverId="102478" X="-876.658" Y="4379.09" Z="739.1406" />
			<While Condition="DoQuest(41415)" >
				<CustomBehavior File="InteractWith" MobId="100810" GossipOptions="1" QuestId="41415" QuestObjectiveIndex="1" X="-791.3507" Y="4386.046" Z="740.1577" />
				<CustomBehavior File="InteractWith" MobId="99986" GossipOptions="1" QuestId="41415" QuestObjectiveIndex="3" X="-932.0243" Y="4415.24" Z="743.9978" />
				<CustomBehavior File="InteractWith" MobId="100171" GossipOptions="1" QuestId="41415" QuestObjectiveIndex="2" X="-893.8386" Y="4524.967" Z="730.6968" />
			</While>
			<TurnIn QuestName="The Hunter's Call" QuestId="41415" TurnInName="Emmarel Shadewarden" TurnInId="102478" X="-876.658" Y="4379.09" Z="739.1406" />

			<PickUp QuestName="Weapons of Legend" QuestId="40618" GiverName="Emmarel Shadewarden" GiverId="102478" X="-876.658" Y="4379.09" Z="739.1406" />
			<While Condition="DoQuest(40618)" >
				<If Condition="!Lua.GetReturnVal&lt;bool&gt;(&quot;return QuestChoiceFrame:IsVisible()&quot;, 0)" >
					<CustomBehavior File="InteractWith" MobId="102478" GossipOptions="1" QuestId="41415" QuestObjectiveIndex="1" X="-876.658" Y="4379.09" Z="739.1406" />
				</If>

				<CustomBehavior File="UserDialog" QuestId="40618" AllowBotStop="True" SoundCue="Exclamation" SoundCueInterval="150" ExpiryTime="300" ExpiryAction="InputEnabled_Continue" 
				Text="Choose an artifact weapon.\n\nIf you do not choose within 5minutes, the bot will pick the one appropriate for your current specialization." />
				
				<If Condition="!IsQuestCompleted(40618)" >
					<If Condition="Me.Specialization == WoWSpec.HunterBeastMastery" >
						<CustomBehavior File="Misc\RunLua" QuestId="40618" Lua="QuestChoiceFrameOption1.OptionButton:Click()" WaitTime="1000" />
					</If>
					<If Condition="Me.Specialization == WoWSpec.HunterSurvival" >
						<CustomBehavior File="Misc\RunLua" QuestId="40618" Lua="QuestChoiceFrameOption2.OptionButton:Click()" WaitTime="1000" />
					</If>
					<If Condition="Me.Specialization == WoWSpec.HunterMarksmanship" >
						<CustomBehavior File="Misc\RunLua" QuestId="40618" Lua="QuestChoiceFrameOption3.OptionButton:Click()" WaitTime="1000" />
					</If>
					<CustomBehavior File="Misc\RunLua" QuestId="40618" Lua="StaticPopup1Button1:Click();" />
				</If>
			</While>
			<TurnIn QuestName="Weapons of Legend" QuestId="40618" TurnInName="Emmarel Shadewarden" TurnInId="102478" X="-876.658" Y="4379.09" Z="739.1406" />

			<If Condition="!IsQuestCompleted(40385) &amp;&amp; NeedsQuest(40953) &amp;&amp; Me.Specialization == WoWSpec.HunterSurvival" > <!-- Talonclaw Finale -->
				<CustomBehavior File="LoadProfile" ProfileName="../Artifact Quests/Survival - Hunter - Talonclaw.xml" />
			</If>
			<If Condition="!IsQuestCompleted(41009) &amp;&amp; NeedsQuest(40953) &amp;&amp; Me.Specialization == WoWSpec.HunterBeastMastery" > <!-- Titanstrike Finale -->
				<CustomBehavior File="LoadProfile" ProfileName="../Artifact Quests/BeastMaster - Hunter - Titanstrike.xml" />
			</If>
			<If Condition="!IsQuestCompleted(40952) &amp;&amp; NeedsQuest(40953) &amp;&amp; Me.Specialization == WoWSpec.HunterMarksmanship" > <!-- Thas'dorah Finale -->
				<CustomBehavior File="LoadProfile" ProfileName="../Artifact Quests/Marksman - Hunter - Thasdorah.xml" />
			</If>

			<PickUp QuestName="On Eagle's Wings" QuestId="40953" GiverName="Emmarel Shadewarden" GiverId="102478" X="-876.658" Y="4379.09" Z="739.1407" /> <!-- Also picked up in the Artifact Quest profiles. -->
			<While Condition="DoQuest(40953)" >
				<!-- NOTE: <ConditionCheck> : Could use a If in Dalaran condition here before using this interact. -->
				<CustomBehavior File="InteractWith" MobId="106678" GossipOptions="1" QuestId="96813" QuestObjectiveIndex="1" X="-863.934" Y="4298.434" Z="745.3467" /> <!-- NOTE: <TechnicalCheck> : Taxi button may count as 1. If so, then we need gossip button to be 2. -->
				<CustomBehavior File="WaitTimer" QuestId="40953" QuestObjectiveIndex="2" WaitTime="170000" /> <!-- NOTE: <TechnicalCheck> : Not sure if IsFlying returns true while flying on this mount -->
			</While>
			<TurnIn QuestName="On Eagle's Wings" QuestId="40953" TurnInName="Emmarel Shadewarden" TurnInId="102578" X="4627.369" Y="5337.927" Z="849.1692" />
			<!-- END Loc: Dalaran -->

			<!-- Loc: Trueshot Lodge -->
			<PickUp QuestName="The Unseen Path" QuestId="40954" GiverName="Emmarel Shadewarden" GiverId="102578" X="4627.369" Y="5337.927" Z="849.1692" />
			<While Condition="DoQuest(40954)" >
				<MoveTo X="4652.311" Y="5284.013" Z="840.8151" />
				<CustomBehavior File="WaitTimer" QuestId="40954" WaitTime="75000" />
			</While>
			<TurnIn QuestName="The Unseen Path" QuestId="40954" TurnInName="Emmarel Shadewarden" TurnInId="102574" X="4650.709" Y="5284.17" Z="840.6922" />

			<PickUp QuestName="Oath of Service" QuestId="40955" GiverName="Emmarel Shadewarden" GiverId="102574" X="4650.709" Y="5284.17" Z="840.6922" />
			<While Condition="DoQuest(40955)" >
				<CustomBehavior File="InteractWith" MobId="102694" WaitTime="12000" QuestId="40954" QuestObjectiveIndex="1" X="4634.74" Y="5278.453" Z="840.7027" />
			</While>
			<TurnIn QuestName="Oath of Service" QuestId="40955" TurnInName="Emmarel Shadewarden" TurnInId="102574" X="4650.692" Y="5284.167" Z="840.6912" />

			<PickUp QuestName="Altar of the Eternal Hunt" QuestId="41053" GiverName="Emmarel Shadewarden" GiverId="102574" X="4650.692" Y="5284.167" Z="840.6912" />
			<TurnIn QuestName="Altar of the Eternal Hunt" QuestId="41053" TurnInName="Altar Keeper Biehn" TurnInId="102940" X="4498.039" Y="5254.65" Z="863.7154" />

			<PickUp QuestName="Infused with Power" QuestId="41047" GiverName="Altar Keeper Biehn" GiverId="102940" X="4498.039" Y="5254.65" Z="863.7154" />
			<While Condition="DoQuest(41047)" >
				<!-- /dump GetMouseFocus():GetPowerID(); C_ArtifactUI.AddPower(powerId); -->
				<CustomBehavior File="InteractWith" MobId="245037" WaitTime="2000" QuestId="41047" X="4499.827" Y="5250.55" Z="863.7143" />
				<If Condition="HasItem(128861)" > <!-- Titanstrike -->
				</If>
				<If Condition="HasItem(128808)" > <!-- Talonclaw -->
					<CustomBehavior File="Misc\RunLua" Lua="C_ArtifactUI.AddPower(1338);" />
				</If>
				<If Condition="HasItem(128826)" > <!-- Thas'dorah -->
				</If>
			</While>
			<TurnIn QuestName="Infused with Power" QuestId="41047" TurnInName="Altar Keeper Biehn" TurnInId="102940" X="4498.039" Y="5254.65" Z="863.7154" />

			<PickUp QuestName="Tactical Matters" QuestId="40958" GiverName="Altar Keeper Biehn" GiverId="102940" X="4498.039" Y="5254.65" Z="863.7154" />
			<TurnIn QuestName="Tactical Matters" QuestId="40958" TurnInName="Tactician Tinderfell" TurnInId="103023" X="4534.788" Y="5289.723" Z="862.1301" />

			<PickUp QuestName="The Campaign Begins" QuestId="40959" GiverName="Tactician Tinderfell" GiverId="103023" X="4534.788" Y="5289.723" Z="862.1301" />
			<While Condition="DoQuest(40959)" >
				<CustomBehavior File="InteractWith" MobId="102669" WaitTime="1500" QuestId="40959" QuestObjectiveIndex="1" X="4536.392" Y="5292.927" Z="866.5453" />
				<If Condition="NeedsQuest(39718)" > <!-- Azsuna -->
					<CustomBehavior File="Misc\RunLua" Lua="C_AdventureMap.StartQuest(39718);" WaitTime="1500" /> <!-- Azsuna -->
					<CustomBehavior File="Misc\RunLua" Lua="C_AdventureMap.Close();" WaitTime="1500" />
				</If>
			</While>
			<TurnIn QuestName="The Campaign Begins" QuestId="40959" TurnInName="Tactician Tinderfell" TurnInId="103023" X="4534.788" Y="5289.723" Z="862.1301" />
			<!-- END Loc: Trueshot Lodge -->

			<!-- Azsuna Transition -->
				<While Condition="DoQuest(39718)" >
					<CustomBehavior File="InteractWith" MobId="244510" WaitTime="30000" QuestId="39718" X="4552.774" Y="5244.073" Z="880.768" /> <!-- NOTE: <ConditionalCheck> : TerminateWhen Me In Dalaran -->
				</While>
				<If Condition="QuestDone(39718)" >
					<CustomBehavior File="LoadProfile" ProfileName="../[N-Quest] Azsuna [Echo].xml" />
				</If>
			<!-- END Azsuna Transition -->


		<!-- /// Stage 2 ; Val'sharah -->

			<!-- Loc: Dalaran -->
				<PickUp QuestName="Pledge of Loyalty" QuestId="44090" GiverName="Snowfeather" GiverId="113327" X="-811.9297" Y="4275.153" Z="746.2794" />
				<While Condition="DoQuest(44090)" >
					<!-- NOTE: <ConditionalCheck> : Could use a If in DAlaran check here for this interact and wait timer. -->
					<CustomBehavior File="InteractWith" MobId="108868" GossipOptions="1" X="-809.467" Y="4273.58" Z="746.2847" /> <!-- Fly to Lodge -->
					<CustomBehavior File="WaitTimer" WaitTime="15000" TerminateWhen="!Me.IsFlying" /> <!-- NOTE: <TechnicalCheck> : Not sure if IsFlying returns true while flying on this mount -->
				</While>
			<!-- END Loc: Dalaran -->

			<!-- Loc: Trueshot Lodge -->
				<TurnIn QuestName="Pledge of Loyalty" QuestId="44090" TurnInName="Altar Keeper Biehn" TurnInId="102940" X="4498.039" Y="5254.65" Z="863.7156" />
				<PickUp QuestName="Rise, Champions" QuestId="42519" GiverName="Altar Keeper Biehn" GiverId="102940" X="4498.039" Y="5254.65" Z="863.7156" />

				<While Condition="DoQuest(42519)" >
					<If Condition="!IsObjectiveComplete(1, 42519)" >
						<CustomBehavior File="InteractWith" MobId="107317" QuestId="42519" QuestObjectiveIndex="1" X="4642.032" Y="5285.06" Z="840.6201" />
						<CustomBehavior File="RunCode"><![CDATA[
								await Coroutine.Sleep(1234);
								Lua.DoString("GossipTitleButton1:Click();");
								await Coroutine.Sleep(1275);
								Lua.DoString("QuestFrameCompleteQuestButton:Click();");
								await Coroutine.Sleep(875);
							]]>
						</CustomBehavior>
					</If>
					<If Condition="!IsObjectiveComplete(2, 42519)" >
						<CustomBehavior File="InteractWith" MobId="107315" QuestId="42519" QuestObjectiveIndex="1" X="4489.491" Y="5220.562" Z="862.4443" />
						<CustomBehavior File="RunCode"><![CDATA[
								await Coroutine.Sleep(1275);
								Lua.DoString("QuestFrameCompleteQuestButton:Click();");
								await Coroutine.Sleep(875);
							]]>
						</CustomBehavior>
					</If>
				</While>
				<TurnIn QuestName="Rise, Champions" QuestId="42519" TurnInName="Tactician Tinderfell" TurnInId="103023" X="4534.788" Y="5289.723" Z="862.1311" />

				<!-- NOTE: <NeedAPI> : Need code to support class hall missions
					<PickUp QuestName="Making Contact" QuestId="42523" GiverName="Tactician Tinderfell" GiverId="103023" X="4534.788" Y="5289.723" Z="862.1311" />
					<While Condition="DoQuest(42523)" >
						<CustomBehavior File="InteractWith" MobId="102669" WaitTime="1500" QuestId="42523" QuestObjectiveIndex="1" X="4536.392" Y="5292.927" Z="866.5453" />
						<CustomBehavior File="RunCode" WaitTime="1500"><![CDATA[
								// NOTE: <NeedCode> : Needs code to assign follower to OrderHall mission.
							]]>
						</CustomBehavior>
						<CustomBehavior File="Misc\RunLua" Lua="OrderHallMissionFrame.MissionTab.MissionPage.StartMissionButton:Click();" />

						Assign Combat Ally, not necessarily needed.
						<CustomBehavior File="RunCode"><![CDATA[
								await Coroutine.SLeep(1275);
								Lua.DoString("OrderHallMissionFrameMissions.CombatAllyUI.Available.AddFollowerButton:Click();");
								await Coroutine.Sleep(850);
								// NOTE: <NeedCode> : Needs code to add follower as a combat ally.
							]]>
						</CustomBehavior>
					</While>
				-->


		<!-- /// Stage 3 ; Highmountain -->
    <!-- <PickUp QuestName="The Lone Mountain" QuestId="39733" GiverName="EMPTY" GiverId="1234" XXXX />
			Go to Dalaran and Load Highmountain profile.-->


		<!-- /// Stage 4 ; Stormheim -->
	<!-- <PickUp QuestName="Stormheim" QuestId="39735" GiverName="Outfitter Reynolds" GiverId="103693" XXXX /> 
			Go to Dalaran and Load Stormheim profile -->
		
		<!-- Name="Portal to Dalaran" Entry="244510" X="4552.774" Y="5244.073" Z="880.768" -->

			<!-- END Loc:  Trueshot Lodge -->


	</QuestOrder>
</HBProfile>