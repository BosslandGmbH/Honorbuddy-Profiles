<HBProfile xsi:noNamespaceSchemaLocation="../Schemas/EchoSchema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- Original contribution by EchoTiger -->
	<Name>[N-Quest] Val'sharah [Echo]</Name>

	<MinDurability>0.3</MinDurability>
	<MinFreeBagSlots>3</MinFreeBagSlots>

	<SellGrey>true</SellGrey>
	<SellWhite>true</SellWhite>
	<SellGreen>true</SellGreen>
	<SellBlue>true</SellBlue>
	<SellPurple>false</SellPurple>

	<MailGrey>false</MailGrey>
	<MailWhite>true</MailWhite>
	<MailGreen>true</MailGreen>
	<MailBlue>true</MailBlue>
	<MailPurple>true</MailPurple>

	<TargetElites>true</TargetElites>

	<AvoidMobs>
		<Mob Name="Gravax the Desecrator" Entry="92802" />
		<Mob Name="Magoria" Entry="110423" />
	</AvoidMobs>

	<Mailboxes>
		<!-- Mailboxes in this zone don't seem to be avtive at the moment. -->
	</Mailboxes>

	<Vendors>
		<Vendor Name="Callista Swiftglaive" Type="Repair" Entry="93464" X="2319.413" Y="6611.955" Z="140.3525" /> <!-- Loriathil -->
		<Vendor Name="Javan Clawthorn" Type="Repair" Entry="92000" X="1951.083" Y="6912.71" Z="52.50054" /> <!-- NOTE: <ConditionalCheck> : UseWhen="!DoQuest(38142)" may be preferred here. -->
		<Vendor Name="Anelas Moonstone" Type="Food" Entry="110531" X="2832.1" Y="6480.855" Z="206.4948" />
		<Vendor Name="Vassallorand Nightmist" Type="Repair" Entry="112629" X="2876.16" Y="6754.713" Z="219.5564" />
		<Vendor Name="Faeolas Nightwhisper" Type="Food" Entry="95118" X="3149.257" Y="5772.391" Z="308.2804" />
		<Vendor Name="Vassallorand Nightmist" Type="Repair" Entry="112629" X="2876.16" Y="6754.713" Z="219.5563" />
		<Vendor Name="Rhys Carrington" Type="Repair" Entry="93945" X="2817.958" Y="7264.667" Z="22.13581" /> <!-- Bradensbrook -->
	</Vendors>

<!-- INITORDER COMMENT 
	<InitOrder>
		Perhaps add detection for loading the class hall if player hasn't unlocked this zone yet.
		<CustomBehavior File="Misc\RunLua" Lua="SetCVar('AutoLootDefault', 1)" />

		<CustomBehavior File="EnablePlugin" Names="Anti Drown" />
		<CustomBehavior File="EnablePlugin" Names="Refreshment Detection" />

		<CustomBehavior File="Misc\ProfileCompatibilityInfo" AllowBrokenAddOns="true" AllowBrokenPlugIns="true" />

		<LootMobs Value="true" />
		<TargetingDistance Value="45" /> Use LevelBot default
	</InitOrder>
END INITORDER COMMENT -->

	<QuestOrder> <!-- No checkpoints here. -->
		<!-- RunCode Methods -->
			<CustomBehavior File="RunCode" Type="Definition"><![CDATA[
					bool DoQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (HasQuest(questId) && !IsQuestCompleted(questId)) return true;
						}
						return false;
					}
					bool NeedsQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (!HasQuest(questId) && !IsQuestCompleted(questId)) return true;
						}
						return false;
					}
					bool NeedsBreadcrumbQuest(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (IsQuestCompleted(questId)) return false;
						}
						return true;
					}
					bool QuestDone(params uint[] questIds)
					{
						foreach (var questId in questIds)
						{
							if (HasQuest(questId) && IsQuestCompleted(questId)) return true;
						}
						return false;
					}

					async Task SkipCutscene(int preWait = 3000, int postWait = 3000)
					{
				// Add detection of cutscene here.
						await Coroutine.Sleep(preWait);
				// Test and improve the working method.
						Lua.DoString("MovieFrame:StopMovie(); CinematicFrame_CancelCinematic(); StopCinematic();");
						await Coroutine.Sleep(postWait);
					}
				]]>
			</CustomBehavior>
		<!-- END RunCode Methods -->

		<!-- Zone Introductory Quests -->
			<If Condition="QuestDone(39731)" >
				<TurnIn QuestName="The Tranquil Forest" QuestId="39731" TurnInName="Archmage Khadgar" TurnInId="91172" X="-825.1493" Y="4292.815" Z="746.2756" /> <!-- Breadcrumb from Class Hall -->
			</If>

			<PickUp QuestName="Tying Up Loose Ends" QuestId="39861" GiverName="Archmage Khadgar" GiverId="91172" X="-825.1493" Y="4292.815" Z="746.2756" />
			<While Condition="DoQuest(39861)" >
				<CustomBehavior File="InteractWith" MobId="96813" NonCompeteDistance="0" X="-833.8698" Y="4276.531" Z="746.255" />
				<CustomBehavior File="Misc\RunLua" WaitTime="500" Lua="GossipTitleButton2:Click();" />
				<CustomBehavior File="Misc\RunLua" Lua="StaticPopup1Button1:Click();" />
				<CustomBehavior File="WaitTimer" WaitTime="105000" TerminateWhen="!Me.InVehicle" />
			</While>
			<TurnIn QuestName="Tying Up Loose Ends" QuestId="39861" TurnInName="Vaesdenarus" TurnInId="91462" X="2289.278" Y="6592.807" Z="138.6552" />

			<PickUp QuestName="Cenarius, Keeper of the Grove" QuestId="40122" GiverName="Malfurion Stormrage" GiverId="91462" X="2289.278" Y="6592.807" Z="138.6561" />
			<While Condition="DoQuest(40122)" >
				<CustomBehavior File="InteractWith" MobId="91462" GossipOptions="1" QuestId="40122" QuestObjectiveIndex="1" X="2289.278" Y="6592.807" Z="138.6561" />
				<CustomBehavior File="WaitTimer" WaitTime="60000" /> <!-- NOTE: <Optimization> : Can terminate this via detection when player gets off Malfurion --> 
			</While>
			<TurnIn QuestName="Cenarius, Keeper of the Grove" QuestId="40122" TurnInName="Malfurion Stormrage" TurnInId="91109" X="2610.598" Y="6745.277" Z="106.4467" />


			<PickUp QuestName="Nature's Call" QuestId="38384" GiverName="Malfurion Stormrage" GiverId="91109" X="2610.598" Y="6745.277" Z="106.4467" />
			<TurnIn QuestName="Nature's Call" QuestId="38384" TurnInName="Aranelle" TurnInId="94179" X="2262.594" Y="6609.824" Z="137.9406" />

			<PickUp QuestName="Archdruid of the Vale" QuestId="38382" GiverName="Aranelle" GiverId="94179" X="2262.594" Y="6609.824" Z="137.9406" /> <!-- Archdruid of the Vale breadcrumb -->
			<PickUp QuestName="Archdruid of the Claw" QuestId="38142" GiverName="Aranelle" GiverId="94179" X="2262.594" Y="6609.824" Z="137.9406" /> <!-- Archdruid of the Claw breadcrumb -->
			<PickUp QuestName="Archdruid of Lore" QuestId="38381" GiverName="Aranelle" GiverId="94179" X="2262.594" Y="6609.824" Z="137.9406" /> <!-- Archdruid of the Lore breadcrumb -->
		<!-- END Zone Introductory Quests -->

		<!-- Side Quests -->
			<PickUp QuestName="Thorny Dancing" QuestId="40220" GiverName="Saylanna Riverbreeze" GiverId="93600" X="2032.776" Y="6644.257" Z="84.91025" />
			<PickUp QuestName="Spread Your Lunarwings and Fly" QuestId="40221" GiverName="Saylanna Riverbreeze" GiverId="93600" X="2032.776" Y="6644.257" Z="84.91025" />

			<While Condition="DoQuest(40221)" >
				<CustomBehavior File="InteractWith" MobId="93489" NumOfTimes="8" QuestId="40221" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1990.604" Y="6707.348" Z="74.22243" />
						<Hotspot X="1930.482" Y="6704.452" Z="75.16626" />
						<Hotspot X="1888.888" Y="6569.999" Z="74.17926" />
						<Hotspot X="1800.472" Y="6560.104" Z="75.57483" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="DoQuest(40220)" >
				<CustomBehavior File="KillUntilComplete" MobId="93444" QuestId="40220" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1888.74" Y="6524.705" Z="74.65449" />
						<Hotspot X="1971.427" Y="6571.291" Z="77.63254" />
						<Hotspot X="1910.443" Y="6721.511" Z="80.28133" />
						<Hotspot X="2009.188" Y="6742.221" Z="77.49535" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="DoQuest(38862) || NeedsQuest(38862)" > <!-- Dropped Quest Item: Auto Accept, - Thieving Thistleleaf -->
				<CustomBehavior File="KillUntilComplete" MobIds="91472, 91474, 93444" QuestId="38862" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1888.74" Y="6524.705" Z="74.65449" />
						<Hotspot X="1971.427" Y="6571.291" Z="77.63254" />
						<Hotspot X="1910.443" Y="6721.511" Z="80.28133" />
						<Hotspot X="2009.188" Y="6742.221" Z="77.49535" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="!IsQuestCompleted(38842)" > <!-- Bonus Objective: Faerie Fracas -->
				<CustomBehavior File="InteractWith" MobState="Dead" NumOfTimes="100" TerminateWhen="IsQuestCompleted(38842)" >
					<HuntingGrounds>
						<Hotspot X="1888.74" Y="6524.705" Z="74.65449" />
						<Hotspot X="1971.427" Y="6571.291" Z="77.63254" />
						<Hotspot X="1910.443" Y="6721.511" Z="80.28133" />
						<Hotspot X="2009.188" Y="6742.221" Z="77.49535" />
					</HuntingGrounds>
					<PursuitList>
						<PursueUnit Id="93489" />
						<PursueUnit Id="91472" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="91474" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="93444" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
					</PursuitList>
				</CustomBehavior>
			</While>

			<TurnIn QuestName="Thorny Dancing" QuestId="40220" TurnInName="Saylanna Riverbreeze" TurnInId="93600" X="2032.776" Y="6644.257" Z="84.90976" />
			<TurnIn QuestName="Spread Your Lunarwings and Fly" QuestId="40221" TurnInName="Saylanna Riverbreeze" TurnInId="93600" X="2032.776" Y="6644.257" Z="84.90976" />
			<TurnIn QuestName="Thieving Thistleleaf" QuestId="38862" TurnInName="Saylanna Riverbreeze" TurnInId="93600" X="2032.776" Y="6644.257" Z="84.90976" />
		<!-- END Side Quests -->

		<!-- Story: Archdruid of Lore -->
			<TurnIn QuestName="Archdruid of Lore" QuestId="38381" TurnInName="Elothir" TurnInId="91066" X="2386.075" Y="6914.492" Z="110.4472" /> <!-- Archdruid of the Lore breadcrumb -->

			<PickUp QuestName="Solid as a Rock" QuestId="38235" GiverName="Elothir" GiverId="91066" X="2386.075" Y="6914.492" Z="110.4472" />
			<PickUp QuestName="Death to the Witchmother" QuestId="38225" GiverName="Elothir" GiverId="91066" X="2386.075" Y="6914.492" Z="110.4472" />

			<While Condition="DoQuest(38235, 38225)" >
				<CustomBehavior File="InteractWith" MobId="93640" QuestId="38235" QuestObjectiveIndex="2" InteractBlacklistTimeInSeconds="1" X="2157.769" Y="7033.619" Z="71.09741" />
				<CustomBehavior File="KillUntilComplete" MobId="91130" QuestId="38225" QuestObjectiveIndex="1" X="2105.945" Y="7083.521" Z="63.80593" />
				<CustomBehavior File="InteractWith" MobId="93644" QuestId="38235" QuestObjectiveIndex="3" InteractBlacklistTimeInSeconds="1" X="2198.757" Y="7193.32" Z="57.76998" />
				<CustomBehavior File="InteractWith" MobId="93602" QuestId="38235" QuestObjectiveIndex="1" InteractBlacklistTimeInSeconds="1" X="2385.297" Y="7193.228" Z="71.26111" />
			</While>

			<!--<While Condition="DoQuest(38372)" >  Wretched Sisters, bonus quest.
				NOTE : <AddSupport> : If confirmed, InteractWith should be used on all Bonus Objectives.  We can hybridize InteractWith as a Interact+Kill logic for maximum efficiency.
				InteractByLooting="true" + MobState="Alive"
				<CustomBehavior File="KillUntilComplete" MobIds="94207, 94208, 91598" QuestId="38372" >
				<HuntingGrounds>
					<Hotspot X="2373.859" Y="7112.171" Z="69.56688" />
					<Hotspot  />
					<Hotspot  />
					<Hotspot  />
				</HuntingGrounds>
			</CustomBehavior>
			</While> -->

			<TurnIn QuestName="Solid as a Rock" QuestId="38235" TurnInName="Elothir" TurnInId="91066" X="2386.075" Y="6914.492" Z="110.4475" />
			<TurnIn QuestName="Death to the Witchmother" QuestId="38225" TurnInName="Elothir" TurnInId="91066" X="2386.075" Y="6914.492" Z="110.4475" />
		<!-- END: Archdruid of Lore -->

		<!-- Story: Archdruid of the Claw -->
			<TurnIn QuestName="Archdruid of the Claw" QuestId="38142" TurnInName="Rylissa Bearsong" TurnInId="73426" X="1940.021" Y="6901.733" Z="51.87961" /> <!-- Archdruid of the Claw breadcrumb -->

			<PickUp QuestName="Frenzied Furbolgs" QuestId="38455" GiverName="Rylissa Bearsong" GiverId="73426" X="1940.021" Y="6901.733" Z="51.87961" />
			<PickUp QuestName="Littlefur" QuestId="38922" GiverName="Elder Sookh" GiverId="93890" X="1855.432" Y="6939.188" Z="42.00073" />
			<TurnIn QuestName="Littlefur" QuestId="38922" TurnInName="Littlefur" TurnInId="93581" X="1859.194" Y="7057.379" Z="39.70639" />
			<PickUp QuestName="Totemic Call" QuestId="38246" GiverName="EMPTY" GiverId="93581" X="1859.194" Y="7057.379" Z="39.70639" />

			<While Condition="DoQuest(38246, 38455)" >
				<CustomBehavior File="InteractWith" MobId="242275" QuestId="38246" QuestObjectiveIndex="1" X="1710.122" Y="6912.98" Z="27.09621" />
				<CustomBehavior File="KillUntilComplete" MobIds="91288, 93577, 93578" QuestId="38455" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1811.649" Y="7044.008" Z="40.66652" />
						<Hotspot X="1861.17" Y="7009.837" Z="42.51127" />
						<Hotspot X="1811.936" Y="6978.752" Z="44.43999" />
						<Hotspot X="1900.844" Y="7046.604" Z="68.35616" />
						<Hotspot X="1732.691" Y="6968.743" Z="30.87997" />
						<Hotspot X="1781.627" Y="6928.369" Z="33.3512" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<TurnIn QuestName="Totemic Call" QuestId="38246" TurnInName="Elder Sookh" TurnInId="93890" X="1855.432" Y="6939.188" Z="42.0009" />
			<If Condition="QuestDone(38146)" >
				<TurnIn QuestName="The Chieftain's Beads" QuestId="38146" TurnInName="Elder Sookh" TurnInId="93890" X="1855.432" Y="6939.188" Z="42.0009" />
			</If>
			<TurnIn QuestName="Frenzied Furbolgs" QuestId="38455" TurnInName="Rylissa Bearsong" TurnInId="73426" X="1940.021" Y="6901.733" Z="51.87946" />

			<PickUp QuestName="Awakening the Archdruid" QuestId="38143" GiverName="Rylissa Bearsong" GiverId="73426" X="1940.021" Y="6901.733" Z="51.87946" />
			<TurnIn QuestName="Awakening the Archdruid" QuestId="38143" TurnInName="Koda Steelclaw" TurnInId="91223" X="1813.238" Y="6869.726" Z="-14.32845" />

			<PickUp QuestName="Out of the Dream" QuestId="38145" GiverName="Koda Steelclaw" GiverId="91223" X="1813.222" Y="6869.721" Z="-14.32845" />
			<PickUp QuestName="The Demons Below" QuestId="38144" GiverName="Koda Steelclaw" GiverId="91223" X="1813.222" Y="6869.721" Z="-14.32845" />
			<While Condition="DoQuest(38145, 38144)" >
				<CustomBehavior File="InteractWith" MobIds="91043" NumOfTimes="8" QuestId="38145" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1684.212" Y="6891.877" Z="-9.799621" />
						<Hotspot X="1738.96" Y="6998.24" Z="3.766619" />
						<Hotspot X="1751.922" Y="6905.974" Z="8.994231" />
					</HuntingGrounds>
				</CustomBehavior>
				<CustomBehavior File="KillUntilComplete" MobIds="91645, 91044" QuestId="38144" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="1684.212" Y="6891.877" Z="-9.799621" />
						<Hotspot X="1738.96" Y="6998.24" Z="3.766619" />
						<Hotspot X="1751.922" Y="6905.974" Z="8.994231" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>
			<TurnIn QuestName="The Demons Below" QuestId="38144" TurnInName="Koda Steelclaw" TurnInId="91223" X="1728.068" Y="6860.759" Z="-0.008863658" />
			<TurnIn QuestName="Out of the Dream" QuestId="38145" TurnInName="Koda Steelclaw" TurnInId="91223" X="1728.068" Y="6860.759" Z="-0.008863658" />

			<PickUp QuestName="Entangled Dreams" QuestId="38147" GiverName="Koda Steelclaw" GiverId="91223" X="1728.068" Y="6860.759" Z="-0.008863658" />
			<While Condition="DoQuest(38147)" >
				<CustomBehavior File="KillUntilComplete" MobId="91045" QuestId="38147" QuestObjectiveIndex="1" X="1637.722" Y="6866.023" Z="-20.74207" />
			</While>
			<TurnIn QuestName="Entangled Dreams" QuestId="38147" TurnInName="Koda Steelclaw" TurnInId="91223" X="1969.271" Y="6914.577" Z="56.03535" />
		<!-- END Story: Archdruid of the Claw -->


		<!-- END Story: Archdruid of the Vale -->
			<TurnIn QuestName="Archdruid of the Vale" QuestId="38382" TurnInName="Thaon Moonclaw" TurnInId="95395" X="2274.671" Y="6242.448" Z="122.8316" /> <!-- Archdruid of the Vale breadcrumb -->

			<PickUp QuestName="Dishonored" QuestId="39383" GiverName="EMPTY" GiverId="95395" X="2274.671" Y="6242.448" Z="122.8316" />
			<While Condition="DoQuest(39383)" >
				<CustomBehavior File="KillUntilComplete" MobId="95319" QuestId="39383" QuestObjectiveIndex="1" X="2361.745" Y="6137.636" Z="128.1176" />
			</While>
			<TurnIn QuestName="Dishonored" QuestId="39383" TurnInName="Thaon Moonclaw" TurnInId="95396" X="2330.851" Y="6146.351" Z="126.2492" />

			<PickUp QuestName="The Corruptor" QuestId="39384" GiverName="Thaon Moonclaw" GiverId="95396" X="2330.851" Y="6146.351" Z="126.2492" />
			<While Condition="DoQuest(39384)" >
				<!-- Obj 1 is 'go to location.' -->
				<CustomBehavior File="KillUntilComplete" MobId="95320" QuestId="39384" QuestObjectiveIndex="2" X="2499.676" Y="6027.744" Z="127.9041" />
			</While>
			<TurnIn QuestName="The Corruptor" QuestId="39384" TurnInName="Evelle Nightwhisper" TurnInId="91650" X="2502.21" Y="6013.201" Z="127.5239" />

			<PickUp QuestName="The Nightmare Lord" QuestId="40573" GiverName="Evelle Nightwhisper" GiverId="91650" X="2502.21" Y="6013.201" Z="127.5239" />
			<While Condition="DoQuest(40573)" >
				<CustomBehavior File="InteractWith" MobId="245676" QuestId="40573" QuestObjectiveIndex="1" X="2502.184" Y="6013.19" Z="127.5243" />
				<CustomBehavior File="KillUntilComplete" MobId="95399" QuestId="40573" QuestObjectiveIndex="4" X="2119.677" Y="6059.124" Z="99.43316" />
			</While>
			<TurnIn QuestName="The Nightmare Lord" QuestId="40573" TurnInName="Evelle Nightwhisper" TurnInId="100573" X="2165.318" Y="6171.343" Z="133.3732" />
			<!-- NOTE: <AddBonusObjective> : Moonclaw Vale, 39393 -->
		<!-- Story: Archdruid of the Vale -->

		<!-- Story: Into the Nightmare -->
			<PickUp QuestName="Return to the Grove" QuestId="38323" GiverName="Evelle Nightwhisper" GiverId="100573" X="2165.318" Y="6171.343" Z="133.3732" />
			<TurnIn QuestName="Return to the Grove" QuestId="38323" TurnInName="Malfurion Stormrage" TurnInId="91109" X="2610.598" Y="6745.277" Z="106.4467" />

			<PickUp QuestName="The Emerald Queen" QuestId="38377" GiverName="Malfurion Stormrage" GiverId="91109" X="2610.598" Y="6745.277" Z="106.4467" />
			<While Condition="DoQuest(38377)" >
				<CustomBehavior File="InteractWith" MobId="91109" GossipOptions="1" QuestId="38377" QuestObjectiveIndex="1" X="2610.598" Y="6745.277" Z="106.4467" />
				<CustomBehavior File="RunCode" Code="await SkipCutscene();" />
			</While>
			<TurnIn QuestName="The Emerald Queen" QuestId="38377" TurnInName="Malfurion Stormrage" TurnInId="100387" X="2608.81" Y="6712.01" Z="104.873" />

			<PickUp QuestName="The Temple of Elune" QuestId="38641" GiverName="Ysera" GiverId="98584" X="2636.72" Y="6714.741" Z="105.8864" />
			<TurnIn QuestName="The Temple of Elune" QuestId="38641" TurnInName="Lyanis Moonfall" TurnInId="92680" X="2871.16" Y="6771.768" Z="220.1778" />

			<PickUp QuestName="Tears for Fears" QuestId="38662" GiverName="Lyanis Moonfall" GiverId="92680" X="2871.16" Y="6771.768" Z="220.1778" />
			<PickUp QuestName="Root Cause" QuestId="38655" GiverName="Isoraen Nightstar" GiverId="92697" X="2876.512" Y="6769.636" Z="220.1773" />

			<While Condition="DoQuest(38662)" >
				<MoveTo X="2987.861" Y="6338.324" Z="251.1868" />
			</While>

			<While Condition="DoQuest(38655)" >
				<CustomBehavior File="InteractWith" MobIds="243952, 243953, 243954" NumOfTimes="30" QuestId="38655" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="2965.469" Y="6393.951" Z="228.2658" />
						<Hotspot X="2870.841" Y="6430.634" Z="214.0949" />
						<Hotspot X="2827.512" Y="6346.498" Z="216.2048" />
						<Hotspot X="2938.899" Y="6473.809" Z="206.4743" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<!-- NOTE: <AddBonusObjective> : Defend The Temple, 39029 -->


			<TurnIn QuestName="Tears for Fears" QuestId="38662" TurnInName="Lyanis Moonfall" TurnInId="92680" X="2871.16" Y="6771.768" Z="220.1775" />
			<TurnIn QuestName="Root Cause" QuestId="38655" TurnInName="Isoraen Nightstar" TurnInId="92697" X="2876.512" Y="6769.636" Z="220.1775" />

			<PickUp QuestName="The Die is Cast" QuestId="38663" GiverName="Lyanis Moonfall" GiverId="92680" X="2871.16" Y="6771.768" Z="220.1775" />
			<If Condition="QuestDone(38663)" >
				<TurnIn QuestName="The Die is Cast" QuestId="38663" TurnInName="Ysera" TurnInId="98584" X="2636.72" Y="6714.741" Z="105.886" />
				<CustomBehavior File="RunCode" Code="await SkipCutscene();" />
			</If>

			<PickUp QuestName="Malfurion's Fury" QuestId="38595" GiverName="Ysera" GiverId="92742" X="2636.72" Y="6714.741" Z="105.8862" />
			<While Condition="DoQuest(38595)" >
				<CustomBehavior File="InteractWith" MobId="92742" GossipOptions="1" QuestId="38595" QuestObjectiveIndex="1" X="2636.72" Y="6714.741" Z="105.8862" />
				<CustomBehavior File="WaitTimer" WaitTime="35000" QuestId="38595" QuestObjectiveIndex="2" />
			</While>
			<TurnIn QuestName="Malfurion's Fury" QuestId="38595" TurnInName="Ysera" TurnInId="92420" X="2708.047" Y="6271.056" Z="223.4982" />

			<PickUp QuestName="To Old Friends" QuestId="38582" GiverName="Ysera" GiverId="92420" X="2708.047" Y="6271.056" Z="223.4982" />
			<While Condition="DoQuest(38582)" >
				<!-- NOTE: <AddHook> : Player recvies a zone buff which can be used for massive AoE damage.  Need to detect aggro count - and use spell accordingly as it has a 5second cooldown.
									Ideally, the player should be pulling masses of mobs and using this spell to kill them as the kill count required to complete the quest is 50 kills.
				--> 
				<CustomBehavior File="Hooks\DoWhen" ActivityName="YseraWrath" AllowUseDuringCombat="true" LogExecution="false" UseAtInterval="5000" >
					<CustomBehavior File="RunCode"><![CDATA[
							if (Me.CurrentTarget != null)
							{
								Lua.DoString("ExtraActionButton1:Click();");
								await Coroutine.Sleep(50);
								SpellManager.ClickRemoteLocation(Me.CurrentTarget.Location);
							}

						]]>
					</CustomBehavior>
				</CustomBehavior>

				<CustomBehavior File="KillUntilComplete" MobIds="114216, 114215, 114219, 92332" QuestId="38582" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="2695.849" Y="6112.126" Z="247.5138" />
						<Hotspot X="2814.905" Y="6093.722" Z="242.6541" />
						<Hotspot X="2935.454" Y="6139.794" Z="260.0298" />
						<Hotspot X="2970.862" Y="6066.421" Z="262.0724" />
						<Hotspot X="2876.041" Y="6029.743" Z="261.1362" />
					</HuntingGrounds>
				</CustomBehavior>

				<CustomBehavior File="Hooks\DoWhen" ActivityName="YseraWrath" Command="Remove" />
				<!-- NOTE: <DisableHook> : As the player enters this new zoneId as per the KillUntilComplete, the zone spell is removed.
										The hook should be detecting the player's current ZoneId to prevent it from casting when it can't.
										The spell is also disabeld after quest is complete.
				-->
				<CustomBehavior File="KillUntilComplete" MobId="92335" QuestId="38582" QuestObjectiveIndex="3" X="2828.71" Y="5898.744" Z="234.482" />
			</While>
			<TurnIn QuestName="To Old Friends" QuestId="38582" TurnInName="Ysera" TurnInId="92710" X="2717.447" Y="6027.452" Z="267.481" />

			<PickUp QuestName="The Demon's Trail" QuestId="38753" GiverName="Ysera" GiverId="92710" X="2717.447" Y="6027.452" Z="267.481" />
			<While Condition="DoQuest(38753)" >
				<MoveTo X="2867.59" Y="5890.754" Z="299.1172" /> <!-- NOTE: <TerminationNeeded> : This MoveTo needs to terminate once the cutscene is detected so the cutscenes can be skipped.
																	  NOTE: <LocationCheck> : Make sure this MoveTo is close enough to trigger the cutscenes. -->
				<CustomBehavior File="RunCode" Code="await SkipCutscene(3000, 5000);" /> <!-- NOTE: <TimerCheck> : Make sure the first cutscene skip waits long enough on the postWait. -->
				<CustomBehavior File="RunCode" Code="await SkipCutscene();" />
			</While>
			<TurnIn QuestName="The Demon's Trail" QuestId="38753" TurnInName="Tyrande Whisperwind" TurnInId="102938" X="2903.66" Y="5889.236" Z="297.1159" />
		<!-- END Story: Into the Nightmare -->

		<!-- Story: All Nightmare Long -->
			<If Condition="Me.IsAlliance" >
				<PickUp QuestName="Love Lost" QuestId="41056" GiverName="Tyrande Whisperwind" GiverId="102938" X="2903.66" Y="5889.236" Z="297.1159" />
				<TurnIn QuestName="Love Lost" QuestId="41056" TurnInName="Tyrande Whisperwind" TurnInId="103022" X="3145.665" Y="5774.15" Z="308.1792" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Love Lost" QuestId="41054" GiverName="Tyrande Whisperwind" GiverId="102938" X="2903.66" Y="5889.236" Z="297.1159" />
				<TurnIn QuestName="Love Lost" QuestId="41054" TurnInName="Tyrande Whisperwind" TurnInId="103022" X="3145.665" Y="5774.15" Z="308.1792" />
			</If>

			<If Condition="Me.IsAlliance" >
				<PickUp QuestName="Dark Side of the Moon" QuestId="41708" GiverName="Tyrande Whisperwind" GiverId="103022" X="3145.665" Y="5774.15" Z="308.1792" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Dark Side of the Moon" QuestId="41890" GiverName="Tyrande Whisperwind" GiverId="103022" X="3145.665" Y="5774.15" Z="308.1792" />
			</If>

			<PickUp QuestName="Lost in Retreat" QuestId="38671" GiverName="Mender Onelle" GiverId="94863" X="3151.359" Y="5779.863" Z="308.1489" />
			<PickUp QuestName="Wormtalon Wreckage" QuestId="41707" GiverName="Aldos Duskwing" GiverId="95117" X="3152.448" Y="5777.948" Z="308.1564" />

			<While Condition="DoQuest(38671)" >
				<CustomBehavior File="InteractWith" MobId="248416" NumOfTimes="5" QuestId="38671" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="3076.11" Y="5888.318" Z="279.2135" />
						<Hotspot X="2999.976" Y="5881.062" Z="275.5592" />
						<Hotspot X="3012.064" Y="5915.741" Z="275.668" />
						<Hotspot X="3000.154" Y="5978.801" Z="279.0247" />
						<Hotspot X="3080.02" Y="6016.291" Z="275.4824" />
						<Hotspot X="3114.85" Y="5939.49" Z="285.5481" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>
			<While Condition="DoQuest(41707)" >
				<CustomBehavior File="KillUntilComplete" MobIds="95152, 95138" QuestId="41707" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="3076.11" Y="5888.318" Z="279.2135" />
						<Hotspot X="2999.976" Y="5881.062" Z="275.5592" />
						<Hotspot X="3012.064" Y="5915.741" Z="275.668" />
						<Hotspot X="3000.154" Y="5978.801" Z="279.0247" />
						<Hotspot X="3080.02" Y="6016.291" Z="275.4824" />
						<Hotspot X="3114.85" Y="5939.49" Z="285.5481" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>
			<While Condition="DoQuest(41708, 41890)" >
				<If Condition="(HasQuest(41708) &amp;&amp; !IsObjectiveComplete(1, 41708)) || (HasQuest(41890) &amp;&amp; !IsObjectiveComplete(1, 41890))" >
					<MoveTo X="3126.056" Y="5915.359" Z="287.155" />
				</If>
				<CustomBehavior File="InteractWith" MobId="104739" NonCompeteDistance="0" GossipOptions="1" X="3123.438" Y="5918.229" Z="286.0553" />
				<CustomBehavior File="WaitTimer" WaitTime="300000" TerminateWhen="IsQuestCompleted(41708) || IsQuestCompleted(41890)" />
			</While>

			<If Condition="Me.IsAlliance" >
				<TurnIn QuestName="Dark Side of the Moon" QuestId="41708" TurnInName="Tyrande Whisperwind" TurnInId="104885" X="3123.241" Y="5918.394" Z="286.052" />
			</If>
			<If Condition="Me.IsHorde" >
				<TurnIn QuestName="Dark Side of the Moon" QuestId="41890" TurnInName="Tyrande Whisperwind" TurnInId="104885" X="3123.241" Y="5918.394" Z="286.052" />
			</If>

			<PickUp QuestName="Regroup at the Refuge" QuestId="43576" GiverName="Tyrande Whisperwind" GiverId="104885" X="3145.665" Y="5774.15" Z="308.18" />
			<TurnIn QuestName="Regroup at the Refuge" QuestId="43576" TurnInName="Tyrande Whisperwind" TurnInId="103022" X="3145.665" Y="5774.15" Z="308.18" />

			<TurnIn QuestName="Lost in Retreat" QuestId="38671" TurnInName="Mender Onelle" TurnInId="94863" X="3151.359" Y="5779.863" Z="308.1495" />
			<TurnIn QuestName="Wormtalon Wreckage" QuestId="41707" TurnInName="Aldos Duskwing" TurnInId="95117" X="3152.448" Y="5777.948" Z="308.1561" />

			<If Condition="Me.IsAlliance" >
				<PickUp QuestName="Heart of the Nightmare" QuestId="41724" GiverName="Tyrande Whisperwind" GiverId="103022" X="3145.665" Y="5774.15" Z="308.18" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Heart of the Nightmare" QuestId="38675" GiverName="Tyrande Whisperwind" GiverId="103022" X="3145.665" Y="5774.15" Z="308.18" />
			</If>

			<If Condition="Me.IsAlliance" >
				<TurnIn QuestName="Heart of the Nightmare" QuestId="41724" TurnInName="Tyrande Whisperwind" TurnInId="104728" X="3320.364" Y="5958.033" Z="249.0644" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Heart of the Nightmare" QuestId="38675" GiverName="Tyrande Whisperwind" GiverId="103022" X="3145.665" Y="5774.15" Z="308.18" />
			</If>

			<!-- NOTE: <TechnicalCheck> : This mob's XYZ is wayyyyy off.  This applies for all occurences of mobId 92783. -->
			<PickUp QuestName="Reading the Leaves" QuestId="38684" GiverName="Elothir" GiverId="92783" X="3330.326" Y="5959.685" Z="253.6653" />

			<If Condition="Me.IsAlliance" >
				<PickUp QuestName="Given to Corruption" QuestId="41893" GiverName="Elothir" GiverId="92783" X="3330.326" Y="5959.685" Z="253.6653" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Given to Corruption" QuestId="41749" GiverName="Elothir" GiverId="92783" X="3330.326" Y="5959.685" Z="253.6653" />
			</If>

			<While Condition="DoQuest(41893, 41749)" >
				<CustomBehavior File="KillUntilComplete" MobId="92989" X="3666.594" Y="5815.972" Z="227.9332" TerminateWhen="IsQuestCompleted(41893) || IsQuestCompleted(41749)" />
			</While>
			<While Condition="DoQuest(38684)" >
				<CustomBehavior File="KillUntilComplete" MobIds="97338, 93155, 97337" QuestId="38684" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="3642.128" Y="5843.139" Z="228.5611" />
						<Hotspot X="3574.607" Y="5978.045" Z="262.6809" />
						<Hotspot X="3504.048" Y="5866.792" Z="269.4984" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="DoQuest(43241)" > <!-- Bonus Objective: Flow of the Nightmare -->
				<CustomBehavior File="InteractWith" MobState="Dead" NumOfTimes="100" TerminateWhen="IsQuestCompleted(43241)" >
					<HuntingGrounds>
						<Hotspot X="3239.613" Y="5935.024" Z="263.8969" />
						<Hotspot X="3248.459" Y="6066.122" Z="242.1524" />
						<Hotspot X="3084.166" Y="6120.797" Z="242.1078" />
						<Hotspot X="3142.568" Y="6082.146" Z="244.2564" />
						<Hotspot X="3320.537" Y="6082.48" Z="248.5293" />
					</HuntingGrounds>
					<PursuitList>
						<PursueGameObject Id="251766" />
						<PursueUnit Id="95951" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="92383" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
					</PursuitList>
				</CustomBehavior>
			</While>


			<TurnIn QuestName="Reading the Leaves" QuestId="38684" TurnInName="Elothir" TurnInId="92783" X="3330.326" Y="5959.685" Z="253.6653" />

			<If Condition="Me.IsAlliance" >
				<TurnIn QuestName="Given to Corruption" QuestId="41893" TurnInName="Elothir" TurnInId="92783" X="3330.326" Y="5959.685" Z="253.6653" />
			</If>
			<If Condition="Me.IsHorde" >
				<TurnIn QuestName="Given to Corruption" QuestId="41749" TurnInName="Elothir" TurnInId="92783" X="3330.326" Y="5959.685" Z="253.6653" />
			</If>

			<PickUp QuestName="Softening the Target" QuestId="43702" GiverName="Elothir" GiverId="104728" X="3320.365" Y="5958.033" Z="249.0662" />
			<While Condition="DoQuest(43702)" >
				<!-- NOTE: <ConditionalCheck> : Make sure InVehicle returns true for this mob. -->
				<If Condition="!Me.InVehicle" >
					<CustomBehavior File="InteractWith" MobId="111359" QuestId="43702" X="3317.487" Y="5949.828" Z="251.8741" />
				</If>
				<!-- NOTE: <QBUsage> : Make sure this behavior is setup properly. -->
				<CustomBehavior File="Vehicles\NoControlVehicle" QuestId="43702" TargetId1="109929" TargetId2="109932" TargetId3="109928" TargetId4="109959" TargetId5="109960" TargetId6="109927" TargetId7="109926" AttackButton="1" OftenToUse="2000" VehicleId="38540" MaxRange="100" TypeId="2" />
			</While>
			<TurnIn QuestName="Softening the Target" QuestId="43702" TurnInName="Tyrande Whisperwind" TurnInId="104728" X="3413.7" Y="6124.011" Z="211.797" />

			<If Condition="Me.IsAlliance" >
				<PickUp QuestName="Close Enough to Touch" QuestId="38687" GiverName="Tyrande Whisperwind" GiverId="104728" X="3413.7" Y="6124.011" Z="211.797" />
			</If>
			<If Condition="Me.IsHorde" >
				<PickUp QuestName="Close Enough to Touch" QuestId="41763" GiverName="Tyrande Whisperwind" GiverId="104728" X="3413.7" Y="6124.011" Z="211.797" />
			</If>
			<While Condition="DoQuest(38687, 41763)" >
				<CustomBehavior File="InteractWith" MobId="111258" QuestId="38687" QuestObjectiveIndex="2" InteractBlacklistTimeInSeconds="1" X="3609.905" Y="6132.729" Z="178.1244" />
				<CustomBehavior File="InteractWith" MobId="111260" QuestId="38687" QuestObjectiveIndex="3" InteractBlacklistTimeInSeconds="1" X="3746.8" Y="6165.945" Z="183.9481" />
				<CustomBehavior File="InteractWith" MobId="111259" QuestId="38687" QuestObjectiveIndex="4" InteractBlacklistTimeInSeconds="1" X="3769.656" Y="6349.799" Z="183.9394" /> <!-- Beta XYZ X="3751.627" Y="6315.099" Z="186.5862" /> -->
				<!-- Cheap way of handling the Horde variant.. :P -->
				<CustomBehavior File="InteractWith" MobId="111203" QuestId="41763" QuestObjectiveIndex="2" InteractBlacklistTimeInSeconds="1" X="3609.905" Y="6132.729" Z="178.1244" />
				<CustomBehavior File="InteractWith" MobId="111198" QuestId="41763" QuestObjectiveIndex="3" InteractBlacklistTimeInSeconds="1" X="3746.8" Y="6165.945" Z="183.9481" />
				<CustomBehavior File="InteractWith" MobId="111204" QuestId="41763" QuestObjectiveIndex="4" InteractBlacklistTimeInSeconds="1" X="3769.656" Y="6349.799" Z="183.9394" />
				<If Condition="!IsObjectiveComplete(5, 38687) || !IsObjectiveComplete(5, 41763)" >
					<MoveTo X="3576.754" Y="6388.25" Z="167.5658" /> <!-- NOTE: <TerminationNeeded> : This MoveTo needs to terminate once the cutscene is detected so the cutscenes can be skipped. -->
					<CustomBehavior File="RunCode" Code="await SkipCutscene();" />
				</If>
			</While>
			<If Condition="Me.IsAlliance" >
				<TurnIn QuestName="Close Enough to Touch" QuestId="38687" TurnInName="Tyrande Whisperwind" TurnInId="104799" X="3547.351" Y="6420.47" Z="168.303" />
			</If>
			<If Condition="Me.IsHorde" >
				<TurnIn QuestName="Close Enough to Touch" QuestId="41763" TurnInName="Tyrande Whisperwind" TurnInId="104799" X="3547.351" Y="6420.47" Z="168.303" />
			</If>

			<PickUp QuestName="The Fate of Val'sharah" QuestId="38743" GiverName="Tyrande Whisperwind" GiverId="104799" X="3545.144" Y="6420.871" Z="168.2894" />
			<While Condition="DoQuest(38743)" >
				<CustomBehavior File="InteractWith" MobId="104799" GossipOptions="1" QuestId="38743" QuestObjectiveIndex="1" X="3547.351" Y="6420.47" Z="168.303" />
				<CustomBehavior File="WaitTimer" WaitTime="60000" QuestId="38743" QuestObjectiveIndex="2" /> <!-- NOTE: <Termination> : Can terminate this timer once player is off Tyrande's mount. -->
				<CustomBehavior File="KillUntilComplete" MobId="93065" QuestId="38743" QuestObjectiveIndex="2" X="2912.206" Y="6647.792" Z="215.0921" />
				<CustomBehavior File="RunCode" Code="await SkipCutscene(10000);" />
			</While>
			<TurnIn QuestName="The Fate of Val'sharah" QuestId="38743" TurnInName="Tyrande Whisperwind" TurnInId="104921" X="2911.557" Y="6648.017" Z="215.0923" />
			<!-- NOTE: <BonusObjective> : <PickUp QuestName="Defend The Temple" QuestId="39029" GiverName="Tyrande Whisperwind" GiverId="1234" X="XXX" Y="YYY" Z="ZZZ" /> -->
		<!-- END Story: All Nightmare Long -->

		<!-- Zone Transition Quests -->
			<!-- NOTE: <ComeBackToMe> :
				<PickUp QuestName="Enter the Nightmare" QuestId="40567" GiverName="Tyrande Whisperwind" GiverId="104921" X="2911.557" Y="6648.017" Z="215.0923" />
				This quest currently is broken on the beta.   I believe it's a 'go into dungeon and kill dungeon boss' quest so it may be removable.
			-->
			<PickUp QuestName="The Tears of Elune" QuestId="40890" GiverType="Object" GiverName="Tears of Elune" GiverId="248534" X="2909.45" Y="6660.596" Z="219.3251" /> <!-- End of Val'sharah transition quest. -->
		<!-- END Zone Transition Quests -->

		<!-- Story: Bradensbrook -->
			<PickUp QuestName="A Village in Peril" QuestId="38643" GiverName="Darcy Heathrow" GiverId="92688" X="3025.932" Y="6587.611" Z="203.5966" />
			<TurnIn QuestName="A Village in Peril" QuestId="38643" TurnInName="Mayor Heathrow" TurnInId="92619" X="2797.552" Y="7272.849" Z="21.7222" />

			<PickUp QuestName="Children of the Night" QuestId="38645" GiverName="Commander Jarod Shadowsong" GiverId="92620" X="2798.512" Y="7266.741" Z="21.59023" />
			<PickUp QuestName="The Farmsteads" QuestId="38644" GiverName="Emmeline" GiverId="92683" X="2796.118" Y="7284.813" Z="23.44862" />

			<PickUp QuestName="A Sight For Sore Eyes" QuestId="38646" GiverName="Granny Marl" GiverId="92618" X="2707.609" Y="7462.568" Z="5.31386" />
			<PickUp QuestName="For the Corn!" QuestId="38647" GiverName="Granny Marl" GiverId="92618" X="2707.609" Y="7462.568" Z="5.31386" />

			<While Condition="DoQuest(38647)" >
				<CustomBehavior File="InteractWith" MobIds="242449" NumOfTimes="5" QuestId="38647" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="2682.452" Y="7437.169" Z="5.314364" />
						<Hotspot X="2660.502" Y="7478.074" Z="5.363027" />
						<Hotspot X="2741.396" Y="7497.339" Z="5.323746" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="DoQuest(38646)" >
				<CustomBehavior File="InteractWith" MobIds="93064" InteractByUsingItemId="127030" Range="59" CollectionDistance="200" NumOfTimes="6" QuestId="38646" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="2656.303" Y="7514.062" Z="6.298237" />
						<Hotspot X="2756.457" Y="7498.103" Z="5.326266" />
						<Hotspot X="2713.501" Y="7405.124" Z="6.421977" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<While Condition="DoQuest(38645)" >
				<CustomBehavior File="KillUntilComplete" MobId="94046" QuestId="38645" QuestObjectiveIndex="1" >
					<HuntingGrounds>
						<Hotspot X="2634.21" Y="7481.828" Z="6.105456" />
						<Hotspot X="2695.519" Y="7536.521" Z="5.938887" />
						<Hotspot X="2748.415" Y="7496.963" Z="5.323853" />
					</HuntingGrounds>
				</CustomBehavior>
			</While>

			<!-- NOTE: <AddQuest?> : Quest-The Warden's Signet (38711), optional quest that is started from killing a NPC.  The NPC drops an item.  Turnin is below. -->

			<TurnIn QuestName="A Sight For Sore Eyes" QuestId="38646" TurnInName="Granny Marl" TurnInId="92618" X="2707.609" Y="7462.568" Z="5.314145" />
			<TurnIn QuestName="For the Corn!" QuestId="38647" TurnInName="Granny Marl" TurnInId="92618" X="2707.609" Y="7462.568" Z="5.314145" />

			<If Condition="DoQuest(38644)" > <!-- Using if here because we need to pick up a quest during this. -->
				<If Condition="!IsObjectiveComplete(1, 38644)" >
					<MoveTo X="2568.631" Y="7487.165" Z="28.05258" />
					<CustomBehavior File="WaitTimer" WaitTime="1000" /> <!-- Wait for aggro -->
					<CustomBehavior File="InteractWith" MobId="243007" QuestId="38644" X="2565.066" Y="7486.539" Z="29.5022" /> <!-- NOTE: <Door> : This interacts with an object required to enter the next location. -->
					<CustomBehavior File="InteractWith" MobId="92734" GossipOptions="1" QuestId="38644" QuestObjectiveIndex="1" X="2571.091" Y="7506.483" Z="19.94402" />
					<CustomBehavior File="InteractWith" MobId="243007" QuestId="38644" X="2565.066" Y="7486.539" Z="29.5022" /> <!-- NOTE: <Door> : This interacts with an object required to enter the next location. -->
				</If>
				<CustomBehavior File="InteractWith" MobId="92618" NonCompeteDistance="0" QuestId="38644" QuestObjectiveIndex="2" X="2707.609" Y="7462.568" Z="5.313876" />
				<If Condition="!IsObjectiveComplete(3, 38644)" >
					<MoveTo X="2817.782" Y="7561.732" Z="4.199298" />
				</If>
			</If>

			<PickUp QuestName="Shriek No More" QuestId="39117" GiverName="Cecily Radcliffe" GiverId="94117" X="2816.49" Y="7564.252" Z="4.321269" />
			<While Condition="DoQuest(39117)" >
				<!-- NOTE AddAvoid, get out of purple stuff. -->
				<CustomBehavior File="KillUntilComplete" MobId="94383" QuestId="39117" QuestObjectiveIndex="1" X="2870.828" Y="7617.902" Z="2.028812" />
			</While>
			<TurnIn QuestName="Shriek No More" QuestId="39117" TurnInName="Cecily Radcliffe" TurnInId="94117" X="2816.49" Y="7564.252" Z="4.321269" />

			<TurnIn QuestName="Children of the Night" QuestId="38645" TurnInName="Commander Jarod Shadowsong" TurnInId="92620" X="2798.514" Y="7266.745" Z="21.59058" />
			<!-- NOTE: <AddQuest?> : <TurnIn QuestName="The Warden's Signet" QuestId="38711" TurnInName="Commander Jarod Shadowsong" TurnInId="92620" X="2798.514" Y="7266.745" Z="21.59058" /> -->
			<TurnIn QuestName="The Farmsteads" QuestId="38644" TurnInName="Mayor Heathrow" TurnInId="92619" X="2797.55" Y="7272.851" Z="21.722" />

			<PickUp QuestName="Jarod's Mission" QuestId="38691" GiverName="Commander Jarod Shadowsong" GiverId="92620" X="2798.514" Y="7266.745" Z="21.59058" />
			<While Condition="DoQuest(38691)" >
				<CustomBehavior File="InteractWith" MobId="92620" GossipOptions="1" QuestId="38691" QuestObjectiveIndex="1" X="2798.514" Y="7266.745" Z="21.59058" />
				<CustomBehavior File="WaitTimer" WaitTime="47000" />
			</While>
			<TurnIn QuestName="Jarod's Mission" QuestId="38691" TurnInName="Commander Jarod Shadowsong" TurnInId="92842" X="3017.697" Y="7354.924" Z="37.16674" />
		<!-- END Story: Bradensbrook -->

		<!-- Story: Black Rook Hold -->
			<PickUp QuestName="Kur'talos Ravencrest" QuestId="38718" GiverName="Commander Jarod Shadowsong" GiverId="92842" X="3017.697" Y="7354.924" Z="37.16674" />
			<While Condition="DoQuest(38718)" >
				<MoveTo X="3017.98" Y="7353.309" Z="37.78646" />
				<CustomBehavior File="MyCTM" X="3017.98" Y="7353.309" Z="37.78646" />
				<CustomBehavior File="InteractWith" MobId="243089" IgnoreLosToTarget="true" Range="5" QuestId="38718" QuestObjectiveIndex="1" X="3017.62" Y="7353.377" Z="37.76612" />
			</While>
			<TurnIn QuestName="Kur'talos Ravencrest" QuestId="38718" TurnInName="Commander Jarod Shadowsong" TurnInId="94977" X="3017.602" Y="7361.725" Z="35.23597" />

			<PickUp QuestName="Maiev's Trail" QuestId="38714" GiverName="Lord Kur'talos Ravencrest" GiverId="92850" X="3017.67" Y="7366.88" Z="35.04933" />
			<PickUp QuestName="The Rook's Guard" QuestId="38715" GiverName="Lord Kur'talos Ravencrest" GiverId="92850" X="3017.67" Y="7366.88" Z="35.04933" />

			<While Condition="DoQuest(38714)" >
				<CustomBehavior File="InteractWith" MobId="91859" NonCompeteDistance="0" QuestId="38714" QuestObjectiveIndex="1" X="3072.316" Y="7376.542" Z="64.76587" />
				<CustomBehavior File="InteractWith" MobId="241638" NonCompeteDistance="0" QuestId="38714" QuestObjectiveIndex="2" X="2894.303" Y="7355.077" Z="78.12429" />
				<CustomBehavior File="InteractWith" MobId="241639" NonCompeteDistance="0" QuestId="38714" QuestObjectiveIndex="3" X="3074.422" Y="7290.325" Z="52.31831" />
			</While>

			<While Condition="DoQuest(38715)" >
				<CustomBehavior File="KillUntilComplete" MobId="92963" QuestId="38715" QuestObjectiveIndex="1" X="3052.738" Y="7406.46" Z="65.20383" />
				<CustomBehavior File="KillUntilComplete" MobId="92971" QuestId="38715" QuestObjectiveIndex="2" X="2900.293" Y="7347.424" Z="78.12424" />
				<CustomBehavior File="KillUntilComplete" MobId="92966" QuestId="38715" QuestObjectiveIndex="3" X="3096.058" Y="7245.313" Z="52.7952" />
			</While>

			<TurnIn QuestName="Maiev's Trail" QuestId="38714" TurnInName="Commander Jarod Shadowsong" TurnInId="94977" X="3117.556" Y="7191.446" Z="53.55869" />
			<TurnIn QuestName="The Rook's Guard" QuestId="38715" TurnInName="Commander Jarod Shadowsong" TurnInId="94977" X="3117.556" Y="7191.446" Z="53.55869" />

			<PickUp QuestName="Black Rook Prison" QuestId="38717" GiverName="Commander Jarod Shadowsong" GiverId="94977" X="3117.556" Y="7191.446" Z="53.55869" />
			<While Condition="DoQuest(38717)" >
				<CustomBehavior File="KillUntilComplete" MobId="92419" QuestId="38717" QuestObjectiveIndex="1" X="3256.917" Y="7281.299" Z="90.76955" />
				<!-- NOTE: <Functionality> : Could probably use InteractByLooting with InteractWith as a kill method instead since this quest requires looting an item. -->
			</While>
			<TurnIn QuestName="Black Rook Prison" QuestId="38717" TurnInName="Commander Jarod Shadowsong" TurnInId="92850" X="3338.097" Y="7370.288" Z="16.6435" />

			<If Condition="Me.Class == WoWClass.DemonHunter" >
				<PickUp QuestName="Brotherly Love" QuestId="44457" GiverName="Commander Jarod Shadowsong" GiverId="92850" X="3338.097" Y="7370.288" Z="16.6435" />
				<PickUp QuestName="Illidari Freedom" QuestId="44278" GiverName="Arduen Soulblade" GiverId="93029" X="3335.917" Y="7370.404" Z="16.64133" />
			</If>
			<If Condition="Me.Class != WoWClass.DemonHunter" >
				<PickUp QuestName="Brotherly Love" QuestId="38724" GiverName="Commander Jarod Shadowsong" GiverId="92850" X="3338.097" Y="7370.288" Z="16.6435" />
				<PickUp QuestName="Illidari Freedom" QuestId="38719" GiverName="Arduen Soulblade" GiverId="93029" X="3335.917" Y="7370.404" Z="16.64133" />
			</If>

			<CustomBehavior File="Hooks\DoWhen" ActivityName="OpenDoors" UseWhen="ObjectManager.GetObjectsOfType&lt;WoWGameObject&gt;().FirstOrDefault(x =&gt; x.SubType == WoWGameObjectType.Door &amp;&amp; x.Distance &lt; 5 &amp;&amp; x.State == WoWGameObjectState.Ready) != null" >
				<CustomBehavior File="RunCode" Code="
						var gatePoi = ObjectManager.GetObjectsOfType&lt;WoWGameObject&gt;().FirstOrDefault(x =&gt; x.SubType == WoWGameObjectType.Door &amp;&amp; x.Distance &lt; 5 &amp;&amp; x.State == WoWGameObjectState.Ready);

						while (gatePoi.State == WoWGameObjectState.Ready) 
						{
							gatePoi.Interact();
							await Coroutine.Yield();
						}
					" />
			</CustomBehavior>

			<While Condition="DoQuest(38719, 44278)" >
				<!-- NOTE: <Doors> : This area has several doors in which the bot will need to open while going between these interacts.
					Name="Prison Gate" Entry="243316" X="3381.648" Y="7397.429" Z="15.67497"
				-->
				<CustomBehavior File="InteractWith" MobId="94974" GossipOptions="1" NonCompeteDistance="0" QuestId="38719" QuestObjectiveIndex="1" X="3367.568" Y="7408.228" Z="16.82367" />
				<CustomBehavior File="InteractWith" MobId="94975" GossipOptions="1" NonCompeteDistance="0" QuestId="38719" QuestObjectiveIndex="3" X="3386.103" Y="7419.931" Z="16.76385" />
				<CustomBehavior File="InteractWith" MobId="94976" GossipOptions="1" NonCompeteDistance="0" QuestId="38719" QuestObjectiveIndex="2" X="3399.964" Y="7315.924" Z="25.51813" />

				<CustomBehavior File="InteractWith" MobId="94974" GossipOptions="1" NonCompeteDistance="0" QuestId="44278" QuestObjectiveIndex="1" X="3367.568" Y="7408.228" Z="16.82367" />
				<CustomBehavior File="InteractWith" MobId="94975" GossipOptions="1" NonCompeteDistance="0" QuestId="44278" QuestObjectiveIndex="3" X="3386.103" Y="7419.931" Z="16.76385" />
				<CustomBehavior File="InteractWith" MobId="94976" GossipOptions="1" NonCompeteDistance="0" QuestId="44278" QuestObjectiveIndex="2" X="3399.964" Y="7315.924" Z="25.51813" />

				<MoveTo X="3415.569" Y="7332.56" Z="24.01816" />
			</While>


			<If Condition="Me.Class == WoWClass.DemonHunter" >
				<TurnIn QuestName="Brotherly Love" QuestId="44457" TurnInName="Maiev Shadowsong" TurnInId="92987" X="3418.531" Y="7430.646" Z="16.76402" />
			</If>
			<If Condition="Me.Class != WoWClass.DemonHunter" >
				<TurnIn QuestName="Brotherly Love" QuestId="38724" TurnInName="Maiev Shadowsong" TurnInId="92987" X="3418.531" Y="7430.646" Z="16.76402" />
			</If>

			<PickUp QuestName="Lieutenant of the Tower" QuestId="38721" GiverName="Maiev Shadowsong" GiverId="93027" X="3418.53" Y="7430.705" Z="16.7646" />
			<While Condition="DoQuest(38721)" >
				<CustomBehavior File="KillUntilComplete" MobId="93031" QuestId="38721" QuestObjectiveIndex="1" X="3449.07" Y="7305.792" Z="24.05046" />
				<CustomBehavior File="InteractWith" MobId="243227" GossipOptions="1" X="3469.553" Y="7292.207" Z="23.94489" /> <!-- NOTE: <Conditional> : Port out of area.  May need this outside the loop with a TerminateWhen to shut it off if the player is already out. -->
			</While>

			<CustomBehavior File="Hooks\DoWhen" ActivityName="OpenDoors" Command="Remove" />

			<If Condition="Me.Class == WoWClass.DemonHunter" >
				<TurnIn QuestName="Illidari Freedom" QuestId="44278" TurnInName="Asha Ravensong" TurnInId="95028" X="3089.549" Y="7450.205" Z="52.49718" />
			</If>
			<If Condition="Me.Class != WoWClass.DemonHunter" >
				<TurnIn QuestName="Illidari Freedom" QuestId="38719" TurnInName="Asha Ravensong" TurnInId="95028" X="3089.549" Y="7450.205" Z="52.49718" />
			</If>

			<TurnIn QuestName="Lieutenant of the Tower" QuestId="38721" TurnInName="Maiev Shadowsong" TurnInId="93149" X="3094.365" Y="7464.921" Z="52.85364" />
			<!-- bonus <PickUp QuestName="Black Rook Hold" QuestId="38716" GiverName="Kaldorei Windgryph" GiverId="91839" XXXX /> -->

			<While Condition="!IsQuestCompleted(38716)" >
				<CustomBehavior File="InteractWith" MobState="Dead" NumOfTimes="100" TerminateWhen="IsQuestCompleted(38716)" >
					<HuntingGrounds>
						<Hotspot X="3046.359" Y="7337.608" Z="64.76704" />
						<Hotspot X="3020.972" Y="7250.142" Z="52.79372" />
						<Hotspot X="3042.34" Y="7307.839" Z="51.55747" />
						<Hotspot X="3061.086" Y="7199.141" Z="51.48189" />
						<Hotspot X="2957.162" Y="7293.915" Z="64.76637" />
					</HuntingGrounds>
					<PursuitList>
						<PursueGameObject Id="244994" />
						<PursueGameObject Id="241741" />
						<PursueUnit Id="91860" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="95430" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="92954" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
						<PursueUnit Id="93061" PursueWhen="(UNIT.IsAlive || UNIT.Lootable) &amp;&amp; !UNIT.TaggedByOther" />
					</PursuitList>
				</CustomBehavior>
			</While>
		<!-- END Story: Black Rook Hold -->


		<PickUp QuestName="The Tears of Elune" QuestId="40890" GiverType="Object" GiverName="Tears of Elune" GiverId="248534" X="2909.45" Y="6660.596" Z="219.3251" /> <!-- End of Val'sharah transition quest. -->


		<If Condition="QuestDone(40890)" >
			<CustomBehavior File="RunCode"><![CDATA[
				Logging.Write(System.Windows.Media.Colors.Yellow, "[Profile]: Using Dalaran Hearthstone");
				await CommonCoroutines.StopMoving(); 
				WoWItem dalaranHearth = StyxWoW.Me.BagItems.FirstOrDefault(x => x.Entry == 140192);
				if (dalaranHearth.Cooldown != 0) {
					Logging.Write(System.Windows.Media.Colors.Yellow, "[Profile]: Awaiting cooldown before attempting hearth!");
					await Coroutine.Wait(1200000, () => dalaranHearth.Cooldown == 0);
				}
				dalaranHearth.Interact();
				var currentLoc = StyxWoW.Me.ZoneId;
				await Coroutine.Wait(30000, () => StyxWoW.Me.ZoneId != currentLoc);
				await Coroutine.Sleep(1500);
			]]>
			</CustomBehavior>
			<!-- NOTE: <AddJumplink> : 
				Name="Teleport Pad" Entry="244534" X="-844.5972" Y="4467.76" Z="736.0415"
				Name="Teleport Pad" Entry="244536" X="-844.5972" Y="4467.76" Z="736.0415"
				Goes to trophy room in Dalaran
			-->
			<MoveTo QuestId="40890" QuestObjectiveIndex="1" X="-844.5972" Y="4467.76" Z="736.0415" />
			<TurnIn QuestName="The Tears of Elune" QuestId="40890" TurnInType="Object" TurnInName="Tears of Elune" TurnInId="246466" X="-859.6979" Y="4466.074" Z="591.6784" />
			<!-- NOTE: <AddJumplink> : 
				Name="Teleport Pad" Entry="244560" X="-779.9583" Y="4415.289" Z="602.6288"
				Name="Teleport Pad" Entry="244561" X="-779.9896" Y="4415.237" Z="602.6288"
				Leaves the trophy room in Dalaran
			-->
			<MoveTo X="-779.9896" Y="4415.237" Z="602.6288" />
		</If>

		<!-- Load Class Hall stuff -->
			<!--
			NOTE <ImproveLater> : This is currently the easy solution.
			I'm thinking a RunCode where Me.Class auto-fills the text with using ProfileManager.LoadNew to load the profilewould be more clean.
			-->
			<If Condition="Me.Class == WoWClass.Warrior" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Warrior [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Paladin" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Paladin [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Hunter" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Hunter [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Rogue" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Rogue [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Priest" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Priest [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.DeathKnight" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Death Knight [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Shaman" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Shaman [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Mage" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Mage [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Warlock" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Warlock [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Monk" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Monk [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.Druid" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Druid [Echo]" />
			</If>
			<If Condition="Me.Class == WoWClass.DemonHunter" >
				<CustomBehavior File="LoadProfile" ProfileName="Class Hall Loaders/[N-Quest] Demon Hunter [Echo]" />
			</If>
		<!-- END Load Class Hall stuff -->


	</QuestOrder>
</HBProfile>